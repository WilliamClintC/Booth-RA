<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.43">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Housing Wealth Analysis: Black vs White Households (1989-2016)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="main_files/libs/clipboard/clipboard.min.js"></script>
<script src="main_files/libs/quarto-html/quarto.js"></script>
<script src="main_files/libs/quarto-html/popper.min.js"></script>
<script src="main_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="main_files/libs/quarto-html/anchor.min.js"></script>
<link href="main_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="main_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="main_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="main_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="main_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Housing Wealth Analysis: Black vs White Households (1989-2016)</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div id="abfc508d" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="vs">r'C:\Users\clint\Desktop\Booth RA\RA_21_22.csv'</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">weight</th>
<th data-quarto-table-cell-role="th">year</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">sex</th>
<th data-quarto-table-cell-role="th">education</th>
<th data-quarto-table-cell-role="th">race</th>
<th data-quarto-table-cell-role="th">asset_total</th>
<th data-quarto-table-cell-role="th">asset_housing</th>
<th data-quarto-table-cell-role="th">debt_total</th>
<th data-quarto-table-cell-role="th">debt_housing</th>
<th data-quarto-table-cell-role="th">income</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>6859.959728</td>
<td>1989</td>
<td>35</td>
<td>female</td>
<td>no college</td>
<td>white</td>
<td>3731.72</td>
<td>0.00</td>
<td>1530.01</td>
<td>0.00</td>
<td>9737.17</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>7375.788638</td>
<td>1989</td>
<td>35</td>
<td>female</td>
<td>no college</td>
<td>black</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
<td>11684.60</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>4193.294199</td>
<td>1989</td>
<td>40</td>
<td>male</td>
<td>no college</td>
<td>other</td>
<td>216439.77</td>
<td>139939.51</td>
<td>26681.80</td>
<td>18658.60</td>
<td>83739.63</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4743.208024</td>
<td>1989</td>
<td>51</td>
<td>female</td>
<td>no college</td>
<td>black</td>
<td>40060.02</td>
<td>18658.60</td>
<td>26383.26</td>
<td>5597.58</td>
<td>19474.33</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5971.319496</td>
<td>1989</td>
<td>28</td>
<td>male</td>
<td>no college</td>
<td>black</td>
<td>35675.24</td>
<td>33585.48</td>
<td>27987.90</td>
<td>20524.46</td>
<td>35053.80</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">47771</td>
<td>3033.103970</td>
<td>2016</td>
<td>43</td>
<td>male</td>
<td>some college</td>
<td>white</td>
<td>253300.00</td>
<td>0.00</td>
<td>96500.00</td>
<td>0.00</td>
<td>113415.28</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">47772</td>
<td>5721.988043</td>
<td>2016</td>
<td>67</td>
<td>male</td>
<td>some college</td>
<td>white</td>
<td>279400.00</td>
<td>120000.00</td>
<td>15000.00</td>
<td>0.00</td>
<td>109364.73</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">47773</td>
<td>4824.390087</td>
<td>2016</td>
<td>60</td>
<td>male</td>
<td>college degree</td>
<td>white</td>
<td>1500.00</td>
<td>0.00</td>
<td>35000.00</td>
<td>0.00</td>
<td>40505.46</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">47774</td>
<td>4132.549093</td>
<td>2016</td>
<td>48</td>
<td>female</td>
<td>no college</td>
<td>white</td>
<td>4430.00</td>
<td>0.00</td>
<td>100.00</td>
<td>0.00</td>
<td>23290.64</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">47775</td>
<td>4461.752118</td>
<td>2016</td>
<td>29</td>
<td>male</td>
<td>some college</td>
<td>white</td>
<td>92600.00</td>
<td>0.00</td>
<td>15900.00</td>
<td>0.00</td>
<td>21265.36</td>
</tr>
</tbody>
</table>

<p>47776 rows × 11 columns</p>
</div>
</div>
</div>
<div id="f7eeec3a" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># COMPREHENSIVE DATA QUALITY ASSESSMENT</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"=== DATA QUALITY ASSESSMENT ===</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Basic dataset information</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"1. DATASET OVERVIEW:"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   Shape: </span><span class="sc">{</span>df<span class="sc">.</span>shape[<span class="dv">0</span>]<span class="sc">:,}</span><span class="ss"> rows × </span><span class="sc">{</span>df<span class="sc">.</span>shape[<span class="dv">1</span>]<span class="sc">}</span><span class="ss"> columns"</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   Memory usage: </span><span class="sc">{</span>df<span class="sc">.</span>memory_usage(deep<span class="op">=</span><span class="va">True</span>)<span class="sc">.</span><span class="bu">sum</span>() <span class="op">/</span> <span class="dv">1024</span><span class="op">**</span><span class="dv">2</span><span class="sc">:.2f}</span><span class="ss"> MB"</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   Columns: </span><span class="sc">{</span><span class="bu">list</span>(df.columns)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Missing values analysis</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">2. MISSING VALUES CHECK:"</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>missing_summary <span class="op">=</span> df.isnull().<span class="bu">sum</span>()</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>missing_pct <span class="op">=</span> (df.isnull().<span class="bu">sum</span>() <span class="op">/</span> <span class="bu">len</span>(df)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>missing_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Missing_Count'</span>: missing_summary,</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Missing_Percentage'</span>: missing_pct</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(missing_df[missing_df[<span class="st">'Missing_Count'</span>] <span class="op">&gt;</span> <span class="dv">0</span>])</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> missing_df[<span class="st">'Missing_Count'</span>].<span class="bu">sum</span>() <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"   ✓ No missing values found"</span>)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Data types and value ranges</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">3. DATA TYPES AND RANGES:"</span>)</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> df.columns:</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>    dtype <span class="op">=</span> df[col].dtype</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> df[col].dtype <span class="kw">in</span> [<span class="st">'int64'</span>, <span class="st">'float64'</span>]:</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>        min_val <span class="op">=</span> df[col].<span class="bu">min</span>()</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>        max_val <span class="op">=</span> df[col].<span class="bu">max</span>()</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"   </span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>dtype<span class="sc">}</span><span class="ss"> | Range: </span><span class="sc">{</span>min_val<span class="sc">:,.2f}</span><span class="ss"> to </span><span class="sc">{</span>max_val<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>        unique_count <span class="op">=</span> df[col].nunique()</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"   </span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>dtype<span class="sc">}</span><span class="ss"> | </span><span class="sc">{</span>unique_count<span class="sc">}</span><span class="ss"> unique values"</span>)</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Check for negative values in financial columns</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">4. NEGATIVE VALUES CHECK:"</span>)</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>financial_cols <span class="op">=</span> [<span class="st">'weight'</span>, <span class="st">'asset_total'</span>, <span class="st">'asset_housing'</span>, <span class="st">'debt_total'</span>, <span class="st">'debt_housing'</span>, <span class="st">'income'</span>, <span class="st">'wealth'</span>]</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> financial_cols:</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> col <span class="kw">in</span> df.columns:</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>        negative_count <span class="op">=</span> (df[col] <span class="op">&lt;</span> <span class="dv">0</span>).<span class="bu">sum</span>()</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>        negative_pct <span class="op">=</span> (negative_count <span class="op">/</span> <span class="bu">len</span>(df)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> negative_count <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"   ⚠️ </span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>negative_count<span class="sc">:,}</span><span class="ss"> negative values (</span><span class="sc">{</span>negative_pct<span class="sc">:.2f}</span><span class="ss">%)"</span>)</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"   ✓ </span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">: No negative values"</span>)</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a><span class="co"># 5. Outlier detection using IQR method</span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">5. OUTLIER DETECTION (IQR Method):"</span>)</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> financial_cols:</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> col <span class="kw">in</span> df.columns <span class="kw">and</span> df[col].dtype <span class="kw">in</span> [<span class="st">'int64'</span>, <span class="st">'float64'</span>]:</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>        Q1 <span class="op">=</span> df[col].quantile(<span class="fl">0.25</span>)</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>        Q3 <span class="op">=</span> df[col].quantile(<span class="fl">0.75</span>)</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>        IQR <span class="op">=</span> Q3 <span class="op">-</span> Q1</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>        lower_bound <span class="op">=</span> Q1 <span class="op">-</span> <span class="fl">1.5</span> <span class="op">*</span> IQR</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>        upper_bound <span class="op">=</span> Q3 <span class="op">+</span> <span class="fl">1.5</span> <span class="op">*</span> IQR</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>        outliers <span class="op">=</span> ((df[col] <span class="op">&lt;</span> lower_bound) <span class="op">|</span> (df[col] <span class="op">&gt;</span> upper_bound)).<span class="bu">sum</span>()</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>        outlier_pct <span class="op">=</span> (outliers <span class="op">/</span> <span class="bu">len</span>(df)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"   </span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>outliers<span class="sc">:,}</span><span class="ss"> outliers (</span><span class="sc">{</span>outlier_pct<span class="sc">:.1f}</span><span class="ss">%) | Bounds: [</span><span class="sc">{</span>lower_bound<span class="sc">:,.0f}</span><span class="ss">, </span><span class="sc">{</span>upper_bound<span class="sc">:,.0f}</span><span class="ss">]"</span>)</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a><span class="co"># 6. Categorical variables validation</span></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">6. CATEGORICAL VARIABLES:"</span>)</span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>categorical_cols <span class="op">=</span> [<span class="st">'race'</span>, <span class="st">'education'</span>, <span class="st">'sex'</span>]</span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> categorical_cols:</span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> col <span class="kw">in</span> df.columns:</span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>        value_counts <span class="op">=</span> df[col].value_counts()</span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"   </span><span class="sc">{</span>col<span class="sc">}</span><span class="ss">:"</span>)</span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> value, count <span class="kw">in</span> value_counts.items():</span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>            pct <span class="op">=</span> (count <span class="op">/</span> <span class="bu">len</span>(df)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"     - </span><span class="sc">{</span>value<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>count<span class="sc">:,}</span><span class="ss"> (</span><span class="sc">{</span>pct<span class="sc">:.1f}</span><span class="ss">%)"</span>)</span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a><span class="co"># 7. Year distribution</span></span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">7. YEAR DISTRIBUTION:"</span>)</span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">'year'</span> <span class="kw">in</span> df.columns:</span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>    year_counts <span class="op">=</span> df[<span class="st">'year'</span>].value_counts().sort_index()</span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> year, count <span class="kw">in</span> year_counts.items():</span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>        pct <span class="op">=</span> (count <span class="op">/</span> <span class="bu">len</span>(df)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"   </span><span class="sc">{</span>year<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>count<span class="sc">:,}</span><span class="ss"> observations (</span><span class="sc">{</span>pct<span class="sc">:.1f}</span><span class="ss">%)"</span>)</span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a><span class="co"># 8. Logical consistency checks</span></span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">8. LOGICAL CONSISTENCY CHECKS:"</span>)</span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if housing assets &lt;= total assets</span></span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">'asset_housing'</span> <span class="kw">in</span> df.columns <span class="kw">and</span> <span class="st">'asset_total'</span> <span class="kw">in</span> df.columns:</span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a>    housing_gt_total <span class="op">=</span> (df[<span class="st">'asset_housing'</span>] <span class="op">&gt;</span> df[<span class="st">'asset_total'</span>]).<span class="bu">sum</span>()</span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> housing_gt_total <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"   ⚠️ </span><span class="sc">{</span>housing_gt_total<span class="sc">:,}</span><span class="ss"> cases where housing assets &gt; total assets"</span>)</span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"   ✓ Housing assets ≤ total assets for all cases"</span>)</span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if housing debt &lt;= total debt</span></span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">'debt_housing'</span> <span class="kw">in</span> df.columns <span class="kw">and</span> <span class="st">'debt_total'</span> <span class="kw">in</span> df.columns:</span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a>    housing_debt_gt_total <span class="op">=</span> (df[<span class="st">'debt_housing'</span>] <span class="op">&gt;</span> df[<span class="st">'debt_total'</span>]).<span class="bu">sum</span>()</span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> housing_debt_gt_total <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"   ⚠️ </span><span class="sc">{</span>housing_debt_gt_total<span class="sc">:,}</span><span class="ss"> cases where housing debt &gt; total debt"</span>)</span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"   ✓ Housing debt ≤ total debt for all cases"</span>)</span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if wealth calculation is consistent</span></span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">'wealth'</span> <span class="kw">in</span> df.columns:</span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a>    calculated_wealth <span class="op">=</span> df[<span class="st">'asset_total'</span>] <span class="op">+</span> df[<span class="st">'asset_housing'</span>] <span class="op">-</span> df[<span class="st">'debt_total'</span>] <span class="op">-</span> df[<span class="st">'debt_housing'</span>]</span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a>    wealth_inconsistent <span class="op">=</span> (<span class="bu">abs</span>(df[<span class="st">'wealth'</span>] <span class="op">-</span> calculated_wealth) <span class="op">&gt;</span> <span class="fl">0.01</span>).<span class="bu">sum</span>()</span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> wealth_inconsistent <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"   ⚠️ </span><span class="sc">{</span>wealth_inconsistent<span class="sc">:,}</span><span class="ss"> cases with inconsistent wealth calculation"</span>)</span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="st">"   ✓ Wealth calculation is consistent"</span>)</span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a><span class="co"># 9. Survey weights validation</span></span>
<span id="cb2-107"><a href="#cb2-107" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">9. SURVEY WEIGHTS VALIDATION:"</span>)</span>
<span id="cb2-108"><a href="#cb2-108" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">'weight'</span> <span class="kw">in</span> df.columns:</span>
<span id="cb2-109"><a href="#cb2-109" aria-hidden="true" tabindex="-1"></a>    zero_weights <span class="op">=</span> (df[<span class="st">'weight'</span>] <span class="op">==</span> <span class="dv">0</span>).<span class="bu">sum</span>()</span>
<span id="cb2-110"><a href="#cb2-110" aria-hidden="true" tabindex="-1"></a>    very_small_weights <span class="op">=</span> (df[<span class="st">'weight'</span>] <span class="op">&lt;</span> <span class="dv">1</span>).<span class="bu">sum</span>()</span>
<span id="cb2-111"><a href="#cb2-111" aria-hidden="true" tabindex="-1"></a>    very_large_weights <span class="op">=</span> (df[<span class="st">'weight'</span>] <span class="op">&gt;</span> <span class="dv">50000</span>).<span class="bu">sum</span>()</span>
<span id="cb2-112"><a href="#cb2-112" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-113"><a href="#cb2-113" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"   Zero weights: </span><span class="sc">{</span>zero_weights<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb2-114"><a href="#cb2-114" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"   Very small weights (&lt;1): </span><span class="sc">{</span>very_small_weights<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb2-115"><a href="#cb2-115" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"   Very large weights (&gt;50K): </span><span class="sc">{</span>very_large_weights<span class="sc">:,}</span><span class="ss">"</span>)</span>
<span id="cb2-116"><a href="#cb2-116" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"   Weight statistics: Mean=</span><span class="sc">{</span>df[<span class="st">'weight'</span>]<span class="sc">.</span>mean()<span class="sc">:.1f}</span><span class="ss">, Median=</span><span class="sc">{</span>df[<span class="st">'weight'</span>]<span class="sc">.</span>median()<span class="sc">:.1f}</span><span class="ss">"</span>)</span>
<span id="cb2-117"><a href="#cb2-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-118"><a href="#cb2-118" aria-hidden="true" tabindex="-1"></a><span class="co"># 10. Summary</span></span>
<span id="cb2-119"><a href="#cb2-119" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">=== DATA QUALITY SUMMARY ==="</span>)</span>
<span id="cb2-120"><a href="#cb2-120" aria-hidden="true" tabindex="-1"></a>issues_found <span class="op">=</span> []</span>
<span id="cb2-121"><a href="#cb2-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-122"><a href="#cb2-122" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> missing_df[<span class="st">'Missing_Count'</span>].<span class="bu">sum</span>() <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb2-123"><a href="#cb2-123" aria-hidden="true" tabindex="-1"></a>    issues_found.append(<span class="st">"Missing values detected"</span>)</span>
<span id="cb2-124"><a href="#cb2-124" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-125"><a href="#cb2-125" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">any</span>((df[col] <span class="op">&lt;</span> <span class="dv">0</span>).<span class="bu">sum</span>() <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">for</span> col <span class="kw">in</span> financial_cols <span class="cf">if</span> col <span class="kw">in</span> df.columns):</span>
<span id="cb2-126"><a href="#cb2-126" aria-hidden="true" tabindex="-1"></a>    issues_found.append(<span class="st">"Negative values in financial columns"</span>)</span>
<span id="cb2-127"><a href="#cb2-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-128"><a href="#cb2-128" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">'asset_housing'</span> <span class="kw">in</span> df.columns <span class="kw">and</span> <span class="st">'asset_total'</span> <span class="kw">in</span> df.columns:</span>
<span id="cb2-129"><a href="#cb2-129" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (df[<span class="st">'asset_housing'</span>] <span class="op">&gt;</span> df[<span class="st">'asset_total'</span>]).<span class="bu">sum</span>() <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb2-130"><a href="#cb2-130" aria-hidden="true" tabindex="-1"></a>        issues_found.append(<span class="st">"Logical inconsistencies (housing &gt; total assets)"</span>)</span>
<span id="cb2-131"><a href="#cb2-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-132"><a href="#cb2-132" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> issues_found:</span>
<span id="cb2-133"><a href="#cb2-133" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"⚠️ Issues found:"</span>)</span>
<span id="cb2-134"><a href="#cb2-134" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> issue <span class="kw">in</span> issues_found:</span>
<span id="cb2-135"><a href="#cb2-135" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"   - </span><span class="sc">{</span>issue<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb2-136"><a href="#cb2-136" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb2-137"><a href="#cb2-137" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"✅ No major data quality issues detected!"</span>)</span>
<span id="cb2-138"><a href="#cb2-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-139"><a href="#cb2-139" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Dataset is ready for analysis with </span><span class="sc">{</span><span class="bu">len</span>(df)<span class="sc">:,}</span><span class="ss"> observations."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== DATA QUALITY ASSESSMENT ===

1. DATASET OVERVIEW:
   Shape: 47,776 rows × 11 columns
   Memory usage: 10.60 MB
   Columns: ['weight', 'year', 'age', 'sex', 'education', 'race', 'asset_total', 'asset_housing', 'debt_total', 'debt_housing', 'income']

2. MISSING VALUES CHECK:
Empty DataFrame
Columns: [Missing_Count, Missing_Percentage]
Index: []
   ✓ No missing values found

3. DATA TYPES AND RANGES:
   weight: float64 | Range: 0.20 to 31,115.82
   year: int64 | Range: 1,989.00 to 2,016.00
   age: int64 | Range: 17.00 to 95.00
   sex: object | 2 unique values
   education: object | 3 unique values
   race: object | 4 unique values
   asset_total: float64 | Range: -22,487,306.62 to 2,928,346,179.67
   asset_housing: float64 | Range: 0.00 to 182,642,128.63
   debt_total: float64 | Range: 0.00 to 293,486,997.64
   debt_housing: float64 | Range: 0.00 to 44,821,081.33
   income: float64 | Range: 0.00 to 351,958,858.31

4. NEGATIVE VALUES CHECK:
   ✓ weight: No negative values
   ⚠️ asset_total: 7 negative values (0.01%)
   ✓ asset_housing: No negative values
   ✓ debt_total: No negative values
   ✓ debt_housing: No negative values
   ✓ income: No negative values

5. OUTLIER DETECTION (IQR Method):
   weight: 330 outliers (0.7%) | Bounds: [-4,095, 12,858]
   asset_total: 8,281 outliers (17.3%) | Bounds: [-2,215,818, 3,831,215]
   asset_housing: 5,405 outliers (11.3%) | Bounds: [-651,383, 1,085,639]
   debt_total: 5,091 outliers (10.7%) | Bounds: [-236,639, 394,398]
   debt_housing: 5,033 outliers (10.5%) | Bounds: [-167,927, 279,879]
   income: 7,542 outliers (15.8%) | Bounds: [-179,464, 385,518]

6. CATEGORICAL VARIABLES:
   race:
     - white: 37,044 (77.5%)
     - black: 5,186 (10.9%)
     - Hispanic: 3,553 (7.4%)
     - other: 1,993 (4.2%)
   education:
     - college degree: 19,444 (40.7%)
     - no college: 17,820 (37.3%)
     - some college: 10,512 (22.0%)
   sex:
     - male: 37,212 (77.9%)
     - female: 10,564 (22.1%)

7. YEAR DISTRIBUTION:
   1989: 3,143 observations (6.6%)
   1992: 3,906 observations (8.2%)
   1995: 4,299 observations (9.0%)
   1998: 4,305 observations (9.0%)
   2001: 4,442 observations (9.3%)
   2004: 4,519 observations (9.5%)
   2007: 4,417 observations (9.2%)
   2010: 6,482 observations (13.6%)
   2013: 6,015 observations (12.6%)
   2016: 6,248 observations (13.1%)

8. LOGICAL CONSISTENCY CHECKS:
   ⚠️ 13 cases where housing assets &gt; total assets
   ✓ Housing debt ≤ total debt for all cases

9. SURVEY WEIGHTS VALIDATION:
   Zero weights: 0
   Very small weights (&lt;1): 9
   Very large weights (&gt;50K): 0
   Weight statistics: Mean=4568.5, Median=4709.3

=== DATA QUALITY SUMMARY ===
⚠️ Issues found:
   - Negative values in financial columns
   - Logical inconsistencies (housing &gt; total assets)

Dataset is ready for analysis with 47,776 observations.</code></pre>
</div>
</div>
<div id="f22565b1" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DATA CLEANING STEP: Fix negative asset_total values</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"=== DATA CLEANING ===</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check for negative asset_total values before cleaning</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>negative_asset_total <span class="op">=</span> (df[<span class="st">'asset_total'</span>] <span class="op">&lt;</span> <span class="dv">0</span>).<span class="bu">sum</span>()</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Before cleaning: </span><span class="sc">{</span>negative_asset_total<span class="sc">:,}</span><span class="ss"> negative asset_total values"</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> negative_asset_total <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Show some examples of negative values</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"Examples of negative asset_total values:"</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    negative_examples <span class="op">=</span> df[df[<span class="st">'asset_total'</span>] <span class="op">&lt;</span> <span class="dv">0</span>][<span class="st">'asset_total'</span>].head(<span class="dv">10</span>)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, val <span class="kw">in</span> <span class="bu">enumerate</span>(negative_examples):</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"  </span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">. $</span><span class="sc">{</span>val<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Store original values for comparison</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    original_asset_total <span class="op">=</span> df[<span class="st">'asset_total'</span>].copy()</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set negative asset_total values to 0</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">'asset_total'</span>] <span class="op">=</span> df[<span class="st">'asset_total'</span>].clip(lower<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Count how many values were changed</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    changed_values <span class="op">=</span> (original_asset_total <span class="op">!=</span> df[<span class="st">'asset_total'</span>]).<span class="bu">sum</span>()</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">✓ Changed </span><span class="sc">{</span>changed_values<span class="sc">:,}</span><span class="ss"> negative asset_total values to 0"</span>)</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Recalculate wealth column since asset_total changed</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>    df[<span class="st">'wealth'</span>] <span class="op">=</span> df[<span class="st">'asset_total'</span>] <span class="op">+</span> df[<span class="st">'asset_housing'</span>] <span class="op">-</span> df[<span class="st">'debt_total'</span>] <span class="op">-</span> df[<span class="st">'debt_housing'</span>]</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"✓ Recalculated wealth column with cleaned asset_total values"</span>)</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Show new statistics</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">After cleaning:"</span>)</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  asset_total min: $</span><span class="sc">{</span>df[<span class="st">'asset_total'</span>]<span class="sc">.</span><span class="bu">min</span>()<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  asset_total max: $</span><span class="sc">{</span>df[<span class="st">'asset_total'</span>]<span class="sc">.</span><span class="bu">max</span>()<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  wealth min: $</span><span class="sc">{</span>df[<span class="st">'wealth'</span>]<span class="sc">.</span><span class="bu">min</span>()<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  wealth max: $</span><span class="sc">{</span>df[<span class="st">'wealth'</span>]<span class="sc">.</span><span class="bu">max</span>()<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"✓ No negative asset_total values found - no cleaning needed"</span>)</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">=== DATA CLEANING COMPLETE ==="</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== DATA CLEANING ===

Before cleaning: 7 negative asset_total values
Examples of negative asset_total values:
  1. $-3,165,711.49
  2. $-5,869.74
  3. $-22,487,306.62
  4. $-14,548,494.22
  5. $-2,422,608.83
  6. $-6,198,904.77
  7. $-2,100,875.73

✓ Changed 7 negative asset_total values to 0
✓ Recalculated wealth column with cleaned asset_total values

After cleaning:
  asset_total min: $0.00
  asset_total max: $2,928,346,179.67
  wealth min: $-221,985,489.24
  wealth max: $2,929,687,834.52

=== DATA CLEANING COMPLETE ===</code></pre>
</div>
</div>
<div id="6bfb0dd1" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a new column 'wealth' using the specified formula</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'wealth'</span>] <span class="op">=</span> df[<span class="st">'asset_total'</span>] <span class="op">+</span> df[<span class="st">'asset_housing'</span>] <span class="op">-</span> df[<span class="st">'debt_total'</span>] <span class="op">-</span> df[<span class="st">'debt_housing'</span>]</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the updated dataframe with the new wealth column</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"New wealth column created with formula: asset_total + asset_housing - debt_total - debt_housing"</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Wealth statistics:"</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Mean: $</span><span class="sc">{</span>df[<span class="st">'wealth'</span>]<span class="sc">.</span>mean()<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Median: $</span><span class="sc">{</span>df[<span class="st">'wealth'</span>]<span class="sc">.</span>median()<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Min: $</span><span class="sc">{</span>df[<span class="st">'wealth'</span>]<span class="sc">.</span><span class="bu">min</span>()<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"  Max: $</span><span class="sc">{</span>df[<span class="st">'wealth'</span>]<span class="sc">.</span><span class="bu">max</span>()<span class="sc">:,.2f}</span><span class="ss">"</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">First few rows with wealth column:"</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>df[[<span class="st">'asset_total'</span>, <span class="st">'asset_housing'</span>, <span class="st">'debt_total'</span>, <span class="st">'debt_housing'</span>, <span class="st">'wealth'</span>]].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>New wealth column created with formula: asset_total + asset_housing - debt_total - debt_housing
Wealth statistics:
  Mean: $9,822,431.82
  Median: $301,893.81
  Min: $-221,985,489.24
  Max: $2,929,687,834.52

First few rows with wealth column:</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">asset_total</th>
<th data-quarto-table-cell-role="th">asset_housing</th>
<th data-quarto-table-cell-role="th">debt_total</th>
<th data-quarto-table-cell-role="th">debt_housing</th>
<th data-quarto-table-cell-role="th">wealth</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>3731.72</td>
<td>0.00</td>
<td>1530.01</td>
<td>0.00</td>
<td>2201.71</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
<td>0.00</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>216439.77</td>
<td>139939.51</td>
<td>26681.80</td>
<td>18658.60</td>
<td>311038.88</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>40060.02</td>
<td>18658.60</td>
<td>26383.26</td>
<td>5597.58</td>
<td>26737.78</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>35675.24</td>
<td>33585.48</td>
<td>27987.90</td>
<td>20524.46</td>
<td>20748.36</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="85f6bff8" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">'ignore'</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Set up plotting style</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>plt.style.use(<span class="st">'default'</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>sns.set_palette(<span class="st">"husl"</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'figure.figsize'</span>] <span class="op">=</span> (<span class="dv">12</span>, <span class="dv">8</span>)</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>plt.rcParams[<span class="st">'font.size'</span>] <span class="op">=</span> <span class="dv">10</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="e3b8da93" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> weighted_median(values, weights):</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Calculate weighted median"""</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove NaN values</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    mask <span class="op">=</span> <span class="op">~</span>(np.isnan(values) <span class="op">|</span> np.isnan(weights))</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    values <span class="op">=</span> values[mask]</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    weights <span class="op">=</span> weights[mask]</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(values) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> np.nan</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Sort values and weights by values</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    sorted_indices <span class="op">=</span> np.argsort(values)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    sorted_values <span class="op">=</span> values[sorted_indices]</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    sorted_weights <span class="op">=</span> weights[sorted_indices]</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate cumulative weights</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>    cumulative_weights <span class="op">=</span> np.cumsum(sorted_weights)</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    total_weight <span class="op">=</span> cumulative_weights[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find the median</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>    median_weight <span class="op">=</span> total_weight <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>    median_index <span class="op">=</span> np.searchsorted(cumulative_weights, median_weight)</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> median_index <span class="op">&lt;</span> <span class="bu">len</span>(sorted_values):</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> cumulative_weights[median_index] <span class="op">==</span> median_weight:</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Exact median</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> (sorted_values[median_index] <span class="op">+</span> sorted_values[median_index <span class="op">+</span> <span class="dv">1</span>]) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> sorted_values[median_index]</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> sorted_values[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Test the function</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Weighted median function created successfully!"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Weighted median function created successfully!</code></pre>
</div>
</div>
<div id="946b0b95" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate weighted median wealth by race and year</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>wealth_by_race_year <span class="op">=</span> []</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> year <span class="kw">in</span> <span class="bu">sorted</span>(df[<span class="st">'year'</span>].unique()):</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> race <span class="kw">in</span> df[<span class="st">'race'</span>].unique():</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>        subset <span class="op">=</span> df[(df[<span class="st">'year'</span>] <span class="op">==</span> year) <span class="op">&amp;</span> (df[<span class="st">'race'</span>] <span class="op">==</span> race)]</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(subset) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>            weighted_med <span class="op">=</span> weighted_median(subset[<span class="st">'wealth'</span>].values, subset[<span class="st">'weight'</span>].values)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>            wealth_by_race_year.append({</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">'year'</span>: year,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">'race'</span>: race,</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>                <span class="st">'weighted_median_wealth'</span>: weighted_med,</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>                <span class="st">'sample_size'</span>: <span class="bu">len</span>(subset)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>wealth_by_race_df <span class="op">=</span> pd.DataFrame(wealth_by_race_year)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Weighted median wealth by race and year:"</span>)</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(wealth_by_race_df.pivot(index<span class="op">=</span><span class="st">'year'</span>, columns<span class="op">=</span><span class="st">'race'</span>, values<span class="op">=</span><span class="st">'weighted_median_wealth'</span>).<span class="bu">round</span>(<span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Weighted median wealth by race and year:
race  Hispanic    black     other     white
year                                       
1989   10710.0   8583.0   68234.0  206364.0
1992   11572.0  22540.0   93916.0  176763.0
1995   29566.0  24179.0   64018.0  177272.0
1998   16378.0  32091.0   80560.0  204646.0
2001   19645.0  31121.0  105001.0  253493.0
2004   23274.0  39234.0  261606.0  253085.0
2007   38330.0  26866.0  242952.0  280379.0
2010   19896.0  19233.0  102797.0  197854.0
2013   14951.0  11548.0  134301.0  202622.0
2016   26800.0  18300.0  150350.0  240350.0</code></pre>
</div>
</div>
<div id="b767156b" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate weighted median wealth by education and year</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>wealth_by_edu_year <span class="op">=</span> []</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> year <span class="kw">in</span> <span class="bu">sorted</span>(df[<span class="st">'year'</span>].unique()):</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> education <span class="kw">in</span> df[<span class="st">'education'</span>].unique():</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>        subset <span class="op">=</span> df[(df[<span class="st">'year'</span>] <span class="op">==</span> year) <span class="op">&amp;</span> (df[<span class="st">'education'</span>] <span class="op">==</span> education)]</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(subset) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>            weighted_med <span class="op">=</span> weighted_median(subset[<span class="st">'wealth'</span>].values, subset[<span class="st">'weight'</span>].values)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>            wealth_by_edu_year.append({</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>                <span class="st">'year'</span>: year,</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">'education'</span>: education,</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>                <span class="st">'weighted_median_wealth'</span>: weighted_med,</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>                <span class="st">'sample_size'</span>: <span class="bu">len</span>(subset)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>wealth_by_edu_df <span class="op">=</span> pd.DataFrame(wealth_by_edu_year)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Weighted median wealth by education and year:"</span>)</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(wealth_by_edu_df.pivot(index<span class="op">=</span><span class="st">'year'</span>, columns<span class="op">=</span><span class="st">'education'</span>, values<span class="op">=</span><span class="st">'weighted_median_wealth'</span>).<span class="bu">round</span>(<span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Weighted median wealth by education and year:
education  college degree  no college  some college
year                                               
1989             346490.0     85699.0      140928.0
1992             242806.0     77481.0      143289.0
1995             264999.0     94289.0      106661.0
1998             342454.0     91552.0      157579.0
2001             470404.0     95652.0      161769.0
2004             469669.0    100725.0      138688.0
2007             536393.0    112559.0      164473.0
2010             369556.0     65546.0       90416.0
2013             390562.0     63258.0       69816.0
2016             410800.0     69921.0       96905.0</code></pre>
</div>
</div>
<div id="3f583161" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create comprehensive visualizations</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>fig, ((ax1, ax2), (ax3, ax4)) <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">16</span>, <span class="dv">12</span>))</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 1: Wealth trends by race</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>pivot_race <span class="op">=</span> wealth_by_race_df.pivot(index<span class="op">=</span><span class="st">'year'</span>, columns<span class="op">=</span><span class="st">'race'</span>, values<span class="op">=</span><span class="st">'weighted_median_wealth'</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> [<span class="st">'#1f77b4'</span>, <span class="st">'#ff7f0e'</span>, <span class="st">'#2ca02c'</span>, <span class="st">'#d62728'</span>]</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, race <span class="kw">in</span> <span class="bu">enumerate</span>([<span class="st">'white'</span>, <span class="st">'black'</span>, <span class="st">'Hispanic'</span>, <span class="st">'other'</span>]):</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> race <span class="kw">in</span> pivot_race.columns:</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>        ax1.plot(pivot_race.index, pivot_race[race], marker<span class="op">=</span><span class="st">'o'</span>, linewidth<span class="op">=</span><span class="fl">2.5</span>, </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>                label<span class="op">=</span>race.title(), color<span class="op">=</span>colors[i], markersize<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Median Wealth Trends by Race (1989-2016)'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Year'</span>)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'Median Wealth ($)'</span>)</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>ax1.legend()</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>ax1.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>ax1.yaxis.set_major_formatter(plt.FuncFormatter(<span class="kw">lambda</span> x, p: <span class="ss">f'$</span><span class="sc">{</span>x<span class="sc">:,.0f}</span><span class="ss">'</span>))</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 2: Wealth trends by education</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>pivot_edu <span class="op">=</span> wealth_by_edu_df.pivot(index<span class="op">=</span><span class="st">'year'</span>, columns<span class="op">=</span><span class="st">'education'</span>, values<span class="op">=</span><span class="st">'weighted_median_wealth'</span>)</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>edu_colors <span class="op">=</span> [<span class="st">'#9467bd'</span>, <span class="st">'#8c564b'</span>, <span class="st">'#e377c2'</span>]</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>edu_order <span class="op">=</span> [<span class="st">'college degree'</span>, <span class="st">'some college'</span>, <span class="st">'no college'</span>]</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, edu <span class="kw">in</span> <span class="bu">enumerate</span>(edu_order):</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> edu <span class="kw">in</span> pivot_edu.columns:</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>        ax2.plot(pivot_edu.index, pivot_edu[edu], marker<span class="op">=</span><span class="st">'s'</span>, linewidth<span class="op">=</span><span class="fl">2.5</span>, </span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>                label<span class="op">=</span>edu.title(), color<span class="op">=</span>edu_colors[i], markersize<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'Median Wealth Trends by Education (1989-2016)'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Year'</span>)</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Median Wealth ($)'</span>)</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>ax2.legend()</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>ax2.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>ax2.yaxis.set_major_formatter(plt.FuncFormatter(<span class="kw">lambda</span> x, p: <span class="ss">f'$</span><span class="sc">{</span>x<span class="sc">:,.0f}</span><span class="ss">'</span>))</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 3: Wealth gap ratios over time (White/Black)</span></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>white_black_ratio <span class="op">=</span> pivot_race[<span class="st">'white'</span>] <span class="op">/</span> pivot_race[<span class="st">'black'</span>]</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>ax3.plot(white_black_ratio.index, white_black_ratio.values, marker<span class="op">=</span><span class="st">'o'</span>, linewidth<span class="op">=</span><span class="dv">3</span>, </span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>         color<span class="op">=</span><span class="st">'red'</span>, markersize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>ax3.set_title(<span class="st">'White-to-Black Wealth Ratio Over Time'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>ax3.set_xlabel(<span class="st">'Year'</span>)</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>ax3.set_ylabel(<span class="st">'Wealth Ratio (White/Black)'</span>)</span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>ax3.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>ax3.axhline(y<span class="op">=</span>white_black_ratio.mean(), color<span class="op">=</span><span class="st">'red'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>, </span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>           label<span class="op">=</span><span class="ss">f'Average: </span><span class="sc">{</span>white_black_ratio<span class="sc">.</span>mean()<span class="sc">:.1f}</span><span class="ss">'</span>)</span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>ax3.legend()</span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 4: Education gap (College/No College)</span></span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>college_no_college_ratio <span class="op">=</span> pivot_edu[<span class="st">'college degree'</span>] <span class="op">/</span> pivot_edu[<span class="st">'no college'</span>]</span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>ax4.plot(college_no_college_ratio.index, college_no_college_ratio.values, marker<span class="op">=</span><span class="st">'s'</span>, </span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a>         linewidth<span class="op">=</span><span class="dv">3</span>, color<span class="op">=</span><span class="st">'purple'</span>, markersize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>ax4.set_title(<span class="st">'College-to-No College Wealth Ratio Over Time'</span>, fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>ax4.set_xlabel(<span class="st">'Year'</span>)</span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>ax4.set_ylabel(<span class="st">'Wealth Ratio (College/No College)'</span>)</span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a>ax4.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a>ax4.axhline(y<span class="op">=</span>college_no_college_ratio.mean(), color<span class="op">=</span><span class="st">'purple'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, alpha<span class="op">=</span><span class="fl">0.7</span>,</span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a>           label<span class="op">=</span><span class="ss">f'Average: </span><span class="sc">{</span>college_no_college_ratio<span class="sc">.</span>mean()<span class="sc">:.1f}</span><span class="ss">'</span>)</span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a>ax4.legend()</span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="main_files/figure-html/cell-10-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="2a9ca5d3" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create heatmap showing wealth by race and education over time</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>fig, (ax1, ax2) <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">18</span>, <span class="dv">6</span>))</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare data for heatmap - Average wealth by race and education</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>heatmap_data <span class="op">=</span> []</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> race <span class="kw">in</span> df[<span class="st">'race'</span>].unique():</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> education <span class="kw">in</span> df[<span class="st">'education'</span>].unique():</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>        subset <span class="op">=</span> df[(df[<span class="st">'race'</span>] <span class="op">==</span> race) <span class="op">&amp;</span> (df[<span class="st">'education'</span>] <span class="op">==</span> education)]</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(subset) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>            weighted_med <span class="op">=</span> weighted_median(subset[<span class="st">'wealth'</span>].values, subset[<span class="st">'weight'</span>].values)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>            heatmap_data.append({</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>                <span class="st">'race'</span>: race,</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>                <span class="st">'education'</span>: education,</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>                <span class="st">'weighted_median_wealth'</span>: weighted_med</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>heatmap_df <span class="op">=</span> pd.DataFrame(heatmap_data)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>heatmap_pivot <span class="op">=</span> heatmap_df.pivot(index<span class="op">=</span><span class="st">'race'</span>, columns<span class="op">=</span><span class="st">'education'</span>, values<span class="op">=</span><span class="st">'weighted_median_wealth'</span>)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Heatmap 1: Overall wealth by race and education</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>sns.heatmap(heatmap_pivot, annot<span class="op">=</span><span class="va">True</span>, fmt<span class="op">=</span><span class="st">'.0f'</span>, cmap<span class="op">=</span><span class="st">'YlOrRd'</span>, ax<span class="op">=</span>ax1, </span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>            cbar_kws<span class="op">=</span>{<span class="st">'label'</span>: <span class="st">'Median Wealth ($)'</span>})</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Overall Median Wealth by Race and Education</span><span class="ch">\n</span><span class="st">(1989-2016 Average)'</span>, </span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'Race'</span>)</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Education Level'</span>)</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Create wealth change comparison (2016 vs 1989)</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>early_data <span class="op">=</span> df[df[<span class="st">'year'</span>] <span class="op">==</span> <span class="dv">1989</span>]</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>recent_data <span class="op">=</span> df[df[<span class="st">'year'</span>] <span class="op">==</span> <span class="dv">2016</span>]</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>change_data <span class="op">=</span> []</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> race <span class="kw">in</span> df[<span class="st">'race'</span>].unique():</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> education <span class="kw">in</span> df[<span class="st">'education'</span>].unique():</span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>        early_subset <span class="op">=</span> early_data[(early_data[<span class="st">'race'</span>] <span class="op">==</span> race) <span class="op">&amp;</span> (early_data[<span class="st">'education'</span>] <span class="op">==</span> education)]</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>        recent_subset <span class="op">=</span> recent_data[(recent_data[<span class="st">'race'</span>] <span class="op">==</span> race) <span class="op">&amp;</span> (recent_data[<span class="st">'education'</span>] <span class="op">==</span> education)]</span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(early_subset) <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">and</span> <span class="bu">len</span>(recent_subset) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>            early_wealth <span class="op">=</span> weighted_median(early_subset[<span class="st">'wealth'</span>].values, early_subset[<span class="st">'weight'</span>].values)</span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>            recent_wealth <span class="op">=</span> weighted_median(recent_subset[<span class="st">'wealth'</span>].values, recent_subset[<span class="st">'weight'</span>].values)</span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> np.isnan(early_wealth) <span class="kw">and</span> <span class="kw">not</span> np.isnan(recent_wealth):</span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>                pct_change <span class="op">=</span> ((recent_wealth <span class="op">-</span> early_wealth) <span class="op">/</span> early_wealth) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>                change_data.append({</span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'race'</span>: race,</span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'education'</span>: education,</span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a>                    <span class="st">'percent_change'</span>: pct_change</span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a>                })</span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a>change_df <span class="op">=</span> pd.DataFrame(change_data)</span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a>change_pivot <span class="op">=</span> change_df.pivot(index<span class="op">=</span><span class="st">'race'</span>, columns<span class="op">=</span><span class="st">'education'</span>, values<span class="op">=</span><span class="st">'percent_change'</span>)</span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Heatmap 2: Percentage change in wealth (2016 vs 1989)</span></span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a>sns.heatmap(change_pivot, annot<span class="op">=</span><span class="va">True</span>, fmt<span class="op">=</span><span class="st">'.1f'</span>, cmap<span class="op">=</span><span class="st">'RdBu_r'</span>, center<span class="op">=</span><span class="dv">0</span>, ax<span class="op">=</span>ax2,</span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a>            cbar_kws<span class="op">=</span>{<span class="st">'label'</span>: <span class="st">'Percent Change (%)'</span>})</span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'Wealth Change: 2016 vs 1989</span><span class="ch">\n</span><span class="st">(Percentage Change)'</span>, </span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Race'</span>)</span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Education Level'</span>)</span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-61"><a href="#cb16-61" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb16-62"><a href="#cb16-62" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="main_files/figure-html/cell-11-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="a50f1b90" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Quantitative Analysis of Trends</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"=== QUANTITATIVE TREND ANALYSIS ===</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate compound annual growth rates (CAGR) for each group</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_cagr(start_value, end_value, years):</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> start_value <span class="op">&lt;=</span> <span class="dv">0</span> <span class="kw">or</span> end_value <span class="op">&lt;=</span> <span class="dv">0</span>:</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> np.nan</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ((end_value <span class="op">/</span> start_value) <span class="op">**</span> (<span class="dv">1</span><span class="op">/</span>years) <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>years_span <span class="op">=</span> <span class="dv">2016</span> <span class="op">-</span> <span class="dv">1989</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"1. COMPOUND ANNUAL GROWTH RATES (1989-2016):"</span>)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   Race Groups:"</span>)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> race <span class="kw">in</span> [<span class="st">'white'</span>, <span class="st">'black'</span>, <span class="st">'Hispanic'</span>, <span class="st">'other'</span>]:</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>    start_val <span class="op">=</span> pivot_race.loc[<span class="dv">1989</span>, race] <span class="cf">if</span> race <span class="kw">in</span> pivot_race.columns <span class="cf">else</span> np.nan</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>    end_val <span class="op">=</span> pivot_race.loc[<span class="dv">2016</span>, race] <span class="cf">if</span> race <span class="kw">in</span> pivot_race.columns <span class="cf">else</span> np.nan</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    cagr <span class="op">=</span> calculate_cagr(start_val, end_val, years_span)</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"   - </span><span class="sc">{</span>race<span class="sc">.</span>title()<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>cagr<span class="sc">:.2f}</span><span class="ss">% per year"</span>)</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">   Education Groups:"</span>)</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> edu <span class="kw">in</span> [<span class="st">'college degree'</span>, <span class="st">'some college'</span>, <span class="st">'no college'</span>]:</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>    start_val <span class="op">=</span> pivot_edu.loc[<span class="dv">1989</span>, edu] <span class="cf">if</span> edu <span class="kw">in</span> pivot_edu.columns <span class="cf">else</span> np.nan</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>    end_val <span class="op">=</span> pivot_edu.loc[<span class="dv">2016</span>, edu] <span class="cf">if</span> edu <span class="kw">in</span> pivot_edu.columns <span class="cf">else</span> np.nan</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>    cagr <span class="op">=</span> calculate_cagr(start_val, end_val, years_span)</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"   - </span><span class="sc">{</span>edu<span class="sc">.</span>title()<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>cagr<span class="sc">:.2f}</span><span class="ss">% per year"</span>)</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Gap analysis</span></span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">2. WEALTH GAP ANALYSIS:"</span>)</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a>white_black_1989 <span class="op">=</span> pivot_race.loc[<span class="dv">1989</span>, <span class="st">'white'</span>] <span class="op">/</span> pivot_race.loc[<span class="dv">1989</span>, <span class="st">'black'</span>]</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>white_black_2016 <span class="op">=</span> pivot_race.loc[<span class="dv">2016</span>, <span class="st">'white'</span>] <span class="op">/</span> pivot_race.loc[<span class="dv">2016</span>, <span class="st">'black'</span>]</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   White-to-Black Ratio: </span><span class="sc">{</span>white_black_1989<span class="sc">:.1f}</span><span class="ss"> (1989) → </span><span class="sc">{</span>white_black_2016<span class="sc">:.1f}</span><span class="ss"> (2016)"</span>)</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>college_no_college_1989 <span class="op">=</span> pivot_edu.loc[<span class="dv">1989</span>, <span class="st">'college degree'</span>] <span class="op">/</span> pivot_edu.loc[<span class="dv">1989</span>, <span class="st">'no college'</span>]</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>college_no_college_2016 <span class="op">=</span> pivot_edu.loc[<span class="dv">2016</span>, <span class="st">'college degree'</span>] <span class="op">/</span> pivot_edu.loc[<span class="dv">2016</span>, <span class="st">'no college'</span>]</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   College-to-No College Ratio: </span><span class="sc">{</span>college_no_college_1989<span class="sc">:.1f}</span><span class="ss"> (1989) → </span><span class="sc">{</span>college_no_college_2016<span class="sc">:.1f}</span><span class="ss"> (2016)"</span>)</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Volatility analysis (coefficient of variation)</span></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">3. WEALTH VOLATILITY (Coefficient of Variation):"</span>)</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   Race Groups:"</span>)</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> race <span class="kw">in</span> [<span class="st">'white'</span>, <span class="st">'black'</span>, <span class="st">'Hispanic'</span>, <span class="st">'other'</span>]:</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> race <span class="kw">in</span> pivot_race.columns:</span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>        cv <span class="op">=</span> (pivot_race[race].std() <span class="op">/</span> pivot_race[race].mean()) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"   - </span><span class="sc">{</span>race<span class="sc">.</span>title()<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>cv<span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">   Education Groups:"</span>)</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> edu <span class="kw">in</span> [<span class="st">'college degree'</span>, <span class="st">'some college'</span>, <span class="st">'no college'</span>]:</span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> edu <span class="kw">in</span> pivot_edu.columns:</span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>        cv <span class="op">=</span> (pivot_edu[edu].std() <span class="op">/</span> pivot_edu[edu].mean()) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"   - </span><span class="sc">{</span>edu<span class="sc">.</span>title()<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>cv<span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Crisis impact analysis (2007-2010)</span></span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">4. FINANCIAL CRISIS IMPACT (2007-2010):"</span>)</span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   Race Groups:"</span>)</span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> race <span class="kw">in</span> [<span class="st">'white'</span>, <span class="st">'black'</span>, <span class="st">'Hispanic'</span>, <span class="st">'other'</span>]:</span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> race <span class="kw">in</span> pivot_race.columns:</span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a>        crisis_decline <span class="op">=</span> ((pivot_race.loc[<span class="dv">2010</span>, race] <span class="op">-</span> pivot_race.loc[<span class="dv">2007</span>, race]) <span class="op">/</span> pivot_race.loc[<span class="dv">2007</span>, race]) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"   - </span><span class="sc">{</span>race<span class="sc">.</span>title()<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>crisis_decline<span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">   Education Groups:"</span>)</span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> edu <span class="kw">in</span> [<span class="st">'college degree'</span>, <span class="st">'some college'</span>, <span class="st">'no college'</span>]:</span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> edu <span class="kw">in</span> pivot_edu.columns:</span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a>        crisis_decline <span class="op">=</span> ((pivot_edu.loc[<span class="dv">2010</span>, edu] <span class="op">-</span> pivot_edu.loc[<span class="dv">2007</span>, edu]) <span class="op">/</span> pivot_edu.loc[<span class="dv">2007</span>, edu]) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"   - </span><span class="sc">{</span>edu<span class="sc">.</span>title()<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>crisis_decline<span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">=== END ANALYSIS ==="</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== QUANTITATIVE TREND ANALYSIS ===

1. COMPOUND ANNUAL GROWTH RATES (1989-2016):
   Race Groups:
   - White: 0.57% per year
   - Black: 2.84% per year
   - Hispanic: 3.46% per year
   - Other: 2.97% per year

   Education Groups:
   - College Degree: 0.63% per year
   - Some College: -1.38% per year
   - No College: -0.75% per year

2. WEALTH GAP ANALYSIS:
   White-to-Black Ratio: 24.0 (1989) → 13.1 (2016)
   College-to-No College Ratio: 4.0 (1989) → 5.9 (2016)

3. WEALTH VOLATILITY (Coefficient of Variation):
   Race Groups:
   - White: 16.1%
   - Black: 40.4%
   - Hispanic: 40.8%
   - Other: 53.5%

   Education Groups:
   - College Degree: 23.9%
   - Some College: 26.3%
   - No College: 19.0%

4. FINANCIAL CRISIS IMPACT (2007-2010):
   Race Groups:
   - White: -29.4%
   - Black: -28.4%
   - Hispanic: -48.1%
   - Other: -57.7%

   Education Groups:
   - College Degree: -31.1%
   - Some College: -45.0%
   - No College: -41.8%

=== END ANALYSIS ===</code></pre>
</div>
</div>
<p>This section focuses specifically on median housing wealth trends for Black and White households, using weighted medians to ensure population-representative results.</p>
<div id="43d58751" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate weighted median housing wealth by race and year (Black and White only)</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>housing_wealth_by_race <span class="op">=</span> []</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Focus on Black and White households only</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>target_races <span class="op">=</span> [<span class="st">'black'</span>, <span class="st">'white'</span>]</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> year <span class="kw">in</span> <span class="bu">sorted</span>(df[<span class="st">'year'</span>].unique()):</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> race <span class="kw">in</span> target_races:</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>        subset <span class="op">=</span> df[(df[<span class="st">'year'</span>] <span class="op">==</span> year) <span class="op">&amp;</span> (df[<span class="st">'race'</span>] <span class="op">==</span> race)]</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(subset) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Use asset_housing for housing wealth</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>            weighted_med_housing <span class="op">=</span> weighted_median(subset[<span class="st">'asset_housing'</span>].values, subset[<span class="st">'weight'</span>].values)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>            housing_wealth_by_race.append({</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>                <span class="st">'year'</span>: year,</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>                <span class="st">'race'</span>: race,</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>                <span class="st">'weighted_median_housing_wealth'</span>: weighted_med_housing,</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>                <span class="st">'sample_size'</span>: <span class="bu">len</span>(subset)</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>housing_wealth_df <span class="op">=</span> pd.DataFrame(housing_wealth_by_race)</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>housing_pivot <span class="op">=</span> housing_wealth_df.pivot(index<span class="op">=</span><span class="st">'year'</span>, columns<span class="op">=</span><span class="st">'race'</span>, values<span class="op">=</span><span class="st">'weighted_median_housing_wealth'</span>)</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Weighted median housing wealth by race and year (Black vs White):"</span>)</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(housing_pivot.<span class="bu">round</span>(<span class="dv">0</span>))</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Data covers </span><span class="sc">{</span><span class="bu">len</span>(df)<span class="sc">}</span><span class="ss"> total observations from </span><span class="sc">{</span>df[<span class="st">'year'</span>]<span class="sc">.</span><span class="bu">min</span>()<span class="sc">}</span><span class="ss"> to </span><span class="sc">{</span>df[<span class="st">'year'</span>]<span class="sc">.</span><span class="bu">max</span>()<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Analysis focuses on </span><span class="sc">{</span><span class="bu">len</span>(df[df[<span class="st">'race'</span>].isin(target_races)])<span class="sc">}</span><span class="ss"> Black and White households"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Weighted median housing wealth by race and year (Black vs White):
race   black     white
year                  
1989     0.0   93293.0
1992     0.0   92239.0
1995     0.0  101790.0
1998     0.0  115086.0
2001     0.0  121937.0
2004  7631.0  158973.0
2007     0.0  162122.0
2010     0.0  138166.0
2013     0.0  128888.0
2016     0.0  130000.0

Data covers 47776 total observations from 1989 to 2016
Analysis focuses on 42230 Black and White households</code></pre>
</div>
</div>
<div id="4805adfa" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create comprehensive visualizations for housing wealth</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>fig, ((ax1, ax2), (ax3, ax4)) <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">16</span>, <span class="dv">12</span>))</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 1: Housing wealth trends by race</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>colors_race <span class="op">=</span> [<span class="st">'#1f77b4'</span>, <span class="st">'#ff7f0e'</span>]  <span class="co"># Blue for White, Orange for Black</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, race <span class="kw">in</span> <span class="bu">enumerate</span>([<span class="st">'white'</span>, <span class="st">'black'</span>]):</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> race <span class="kw">in</span> housing_pivot.columns:</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>        ax1.plot(housing_pivot.index, housing_pivot[race], marker<span class="op">=</span><span class="st">'o'</span>, linewidth<span class="op">=</span><span class="dv">3</span>, </span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>                label<span class="op">=</span><span class="ss">f'</span><span class="sc">{</span>race<span class="sc">.</span>title()<span class="sc">}</span><span class="ss"> Households'</span>, color<span class="op">=</span>colors_race[i], markersize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Median Housing Wealth Trends: Black vs White Households</span><span class="ch">\n</span><span class="st">(1989-2016)'</span>, </span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Year'</span>)</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'Median Housing Wealth ($)'</span>)</span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>ax1.legend()</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>ax1.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>ax1.yaxis.set_major_formatter(plt.FuncFormatter(<span class="kw">lambda</span> x, p: <span class="ss">f'$</span><span class="sc">{</span>x<span class="sc">:,.0f}</span><span class="ss">'</span>))</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 2: Housing wealth gap (absolute difference)</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>white_housing <span class="op">=</span> housing_pivot[<span class="st">'white'</span>]</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>black_housing <span class="op">=</span> housing_pivot[<span class="st">'black'</span>]</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>housing_gap <span class="op">=</span> white_housing <span class="op">-</span> black_housing</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>ax2.fill_between(housing_gap.index, <span class="dv">0</span>, housing_gap.values, alpha<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>ax2.plot(housing_gap.index, housing_gap.values, marker<span class="op">=</span><span class="st">'s'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, </span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>         color<span class="op">=</span><span class="st">'darkred'</span>, markersize<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'Housing Wealth Gap (White - Black)</span><span class="ch">\n</span><span class="st">Absolute Difference'</span>, </span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Year'</span>)</span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Wealth Gap ($)'</span>)</span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>ax2.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>ax2.yaxis.set_major_formatter(plt.FuncFormatter(<span class="kw">lambda</span> x, p: <span class="ss">f'$</span><span class="sc">{</span>x<span class="sc">:,.0f}</span><span class="ss">'</span>))</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 3: Homeownership rates (implied from zero housing wealth)</span></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate percentage with zero housing wealth as proxy for non-homeownership</span></span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>homeownership_data <span class="op">=</span> []</span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> year <span class="kw">in</span> <span class="bu">sorted</span>(df[<span class="st">'year'</span>].unique()):</span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> race <span class="kw">in</span> [<span class="st">'black'</span>, <span class="st">'white'</span>]:</span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>        subset <span class="op">=</span> df[(df[<span class="st">'year'</span>] <span class="op">==</span> year) <span class="op">&amp;</span> (df[<span class="st">'race'</span>] <span class="op">==</span> race)]</span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(subset) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Calculate weighted percentage with housing wealth &gt; 0</span></span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>            has_housing <span class="op">=</span> subset[<span class="st">'asset_housing'</span>] <span class="op">&gt;</span> <span class="dv">0</span></span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>            weighted_homeownership <span class="op">=</span> np.average(has_housing, weights<span class="op">=</span>subset[<span class="st">'weight'</span>]) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>            homeownership_data.append({</span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>                <span class="st">'year'</span>: year,</span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>                <span class="st">'race'</span>: race,</span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>                <span class="st">'homeownership_rate'</span>: weighted_homeownership</span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a>homeownership_df <span class="op">=</span> pd.DataFrame(homeownership_data)</span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a>homeownership_pivot <span class="op">=</span> homeownership_df.pivot(index<span class="op">=</span><span class="st">'year'</span>, columns<span class="op">=</span><span class="st">'race'</span>, values<span class="op">=</span><span class="st">'homeownership_rate'</span>)</span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, race <span class="kw">in</span> <span class="bu">enumerate</span>([<span class="st">'white'</span>, <span class="st">'black'</span>]):</span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> race <span class="kw">in</span> homeownership_pivot.columns:</span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a>        ax3.plot(homeownership_pivot.index, homeownership_pivot[race], marker<span class="op">=</span><span class="st">'o'</span>, linewidth<span class="op">=</span><span class="dv">3</span>, </span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a>                label<span class="op">=</span><span class="ss">f'</span><span class="sc">{</span>race<span class="sc">.</span>title()<span class="sc">}</span><span class="ss"> Households'</span>, color<span class="op">=</span>colors_race[i], markersize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-58"><a href="#cb21-58" aria-hidden="true" tabindex="-1"></a>ax3.set_title(<span class="st">'Homeownership Rates: Black vs White Households</span><span class="ch">\n</span><span class="st">(Households with Housing Assets &gt; $0)'</span>, </span>
<span id="cb21-59"><a href="#cb21-59" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb21-60"><a href="#cb21-60" aria-hidden="true" tabindex="-1"></a>ax3.set_xlabel(<span class="st">'Year'</span>)</span>
<span id="cb21-61"><a href="#cb21-61" aria-hidden="true" tabindex="-1"></a>ax3.set_ylabel(<span class="st">'Homeownership Rate (%)'</span>)</span>
<span id="cb21-62"><a href="#cb21-62" aria-hidden="true" tabindex="-1"></a>ax3.legend()</span>
<span id="cb21-63"><a href="#cb21-63" aria-hidden="true" tabindex="-1"></a>ax3.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb21-64"><a href="#cb21-64" aria-hidden="true" tabindex="-1"></a>ax3.set_ylim(<span class="dv">0</span>, <span class="dv">100</span>)</span>
<span id="cb21-65"><a href="#cb21-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-66"><a href="#cb21-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 4: Housing wealth among homeowners only</span></span>
<span id="cb21-67"><a href="#cb21-67" aria-hidden="true" tabindex="-1"></a>homeowner_housing_data <span class="op">=</span> []</span>
<span id="cb21-68"><a href="#cb21-68" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> year <span class="kw">in</span> <span class="bu">sorted</span>(df[<span class="st">'year'</span>].unique()):</span>
<span id="cb21-69"><a href="#cb21-69" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> race <span class="kw">in</span> [<span class="st">'black'</span>, <span class="st">'white'</span>]:</span>
<span id="cb21-70"><a href="#cb21-70" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Filter to only those with housing assets &gt; 0</span></span>
<span id="cb21-71"><a href="#cb21-71" aria-hidden="true" tabindex="-1"></a>        subset <span class="op">=</span> df[(df[<span class="st">'year'</span>] <span class="op">==</span> year) <span class="op">&amp;</span> (df[<span class="st">'race'</span>] <span class="op">==</span> race) <span class="op">&amp;</span> (df[<span class="st">'asset_housing'</span>] <span class="op">&gt;</span> <span class="dv">0</span>)]</span>
<span id="cb21-72"><a href="#cb21-72" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(subset) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb21-73"><a href="#cb21-73" aria-hidden="true" tabindex="-1"></a>            weighted_med_housing <span class="op">=</span> weighted_median(subset[<span class="st">'asset_housing'</span>].values, subset[<span class="st">'weight'</span>].values)</span>
<span id="cb21-74"><a href="#cb21-74" aria-hidden="true" tabindex="-1"></a>            homeowner_housing_data.append({</span>
<span id="cb21-75"><a href="#cb21-75" aria-hidden="true" tabindex="-1"></a>                <span class="st">'year'</span>: year,</span>
<span id="cb21-76"><a href="#cb21-76" aria-hidden="true" tabindex="-1"></a>                <span class="st">'race'</span>: race,</span>
<span id="cb21-77"><a href="#cb21-77" aria-hidden="true" tabindex="-1"></a>                <span class="st">'median_housing_wealth_homeowners'</span>: weighted_med_housing,</span>
<span id="cb21-78"><a href="#cb21-78" aria-hidden="true" tabindex="-1"></a>                <span class="st">'homeowner_sample_size'</span>: <span class="bu">len</span>(subset)</span>
<span id="cb21-79"><a href="#cb21-79" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb21-80"><a href="#cb21-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-81"><a href="#cb21-81" aria-hidden="true" tabindex="-1"></a>homeowner_housing_df <span class="op">=</span> pd.DataFrame(homeowner_housing_data)</span>
<span id="cb21-82"><a href="#cb21-82" aria-hidden="true" tabindex="-1"></a>homeowner_pivot <span class="op">=</span> homeowner_housing_df.pivot(index<span class="op">=</span><span class="st">'year'</span>, columns<span class="op">=</span><span class="st">'race'</span>, values<span class="op">=</span><span class="st">'median_housing_wealth_homeowners'</span>)</span>
<span id="cb21-83"><a href="#cb21-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-84"><a href="#cb21-84" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, race <span class="kw">in</span> <span class="bu">enumerate</span>([<span class="st">'white'</span>, <span class="st">'black'</span>]):</span>
<span id="cb21-85"><a href="#cb21-85" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> race <span class="kw">in</span> homeowner_pivot.columns:</span>
<span id="cb21-86"><a href="#cb21-86" aria-hidden="true" tabindex="-1"></a>        ax4.plot(homeowner_pivot.index, homeowner_pivot[race], marker<span class="op">=</span><span class="st">'o'</span>, linewidth<span class="op">=</span><span class="dv">3</span>, </span>
<span id="cb21-87"><a href="#cb21-87" aria-hidden="true" tabindex="-1"></a>                label<span class="op">=</span><span class="ss">f'</span><span class="sc">{</span>race<span class="sc">.</span>title()<span class="sc">}</span><span class="ss"> Homeowners'</span>, color<span class="op">=</span>colors_race[i], markersize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb21-88"><a href="#cb21-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-89"><a href="#cb21-89" aria-hidden="true" tabindex="-1"></a>ax4.set_title(<span class="st">'Median Housing Wealth Among Homeowners Only</span><span class="ch">\n</span><span class="st">Black vs White Households'</span>, </span>
<span id="cb21-90"><a href="#cb21-90" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb21-91"><a href="#cb21-91" aria-hidden="true" tabindex="-1"></a>ax4.set_xlabel(<span class="st">'Year'</span>)</span>
<span id="cb21-92"><a href="#cb21-92" aria-hidden="true" tabindex="-1"></a>ax4.set_ylabel(<span class="st">'Median Housing Wealth ($)'</span>)</span>
<span id="cb21-93"><a href="#cb21-93" aria-hidden="true" tabindex="-1"></a>ax4.legend()</span>
<span id="cb21-94"><a href="#cb21-94" aria-hidden="true" tabindex="-1"></a>ax4.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb21-95"><a href="#cb21-95" aria-hidden="true" tabindex="-1"></a>ax4.yaxis.set_major_formatter(plt.FuncFormatter(<span class="kw">lambda</span> x, p: <span class="ss">f'$</span><span class="sc">{</span>x<span class="sc">:,.0f}</span><span class="ss">'</span>))</span>
<span id="cb21-96"><a href="#cb21-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-97"><a href="#cb21-97" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb21-98"><a href="#cb21-98" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb21-99"><a href="#cb21-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-100"><a href="#cb21-100" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Homeownership rates by race and year:"</span>)</span>
<span id="cb21-101"><a href="#cb21-101" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(homeownership_pivot.<span class="bu">round</span>(<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="main_files/figure-html/cell-14-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Homeownership rates by race and year:
race  black  white
year              
1989   42.2   70.5
1992   43.4   70.3
1995   42.8   70.6
1998   46.1   71.8
2001   47.0   74.1
2004   50.4   75.7
2007   48.5   74.8
2010   47.7   74.6
2013   43.9   73.2
2016   44.0   71.9</code></pre>
</div>
</div>
<div id="0ab5d5b9" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Quantitative Analysis of Housing Wealth Trends</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"=== HOUSING WEALTH ANALYSIS: BLACK vs WHITE HOUSEHOLDS ===</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate key statistics</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"1. MEDIAN HOUSING WEALTH AMONG ALL HOUSEHOLDS:"</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   White households (1989):"</span>, <span class="ss">f"$</span><span class="sc">{</span>housing_pivot<span class="sc">.</span>loc[<span class="dv">1989</span>, <span class="st">'white'</span>]<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   White households (2016):"</span>, <span class="ss">f"$</span><span class="sc">{</span>housing_pivot<span class="sc">.</span>loc[<span class="dv">2016</span>, <span class="st">'white'</span>]<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   Black households (1989):"</span>, <span class="ss">f"$</span><span class="sc">{</span>housing_pivot<span class="sc">.</span>loc[<span class="dv">1989</span>, <span class="st">'black'</span>]<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   Black households (2016):"</span>, <span class="ss">f"$</span><span class="sc">{</span>housing_pivot<span class="sc">.</span>loc[<span class="dv">2016</span>, <span class="st">'black'</span>]<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="co"># CAGR for housing wealth</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>white_housing_cagr <span class="op">=</span> calculate_cagr(housing_pivot.loc[<span class="dv">1989</span>, <span class="st">'white'</span>], </span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>                                   housing_pivot.loc[<span class="dv">2016</span>, <span class="st">'white'</span>], years_span)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">   White Housing Wealth CAGR: </span><span class="sc">{</span>white_housing_cagr<span class="sc">:.2f}</span><span class="ss">% per year"</span>)</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Since Black median is mostly 0, calculate differently</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>black_housing_values <span class="op">=</span> housing_pivot[<span class="st">'black'</span>].dropna()</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>black_positive_years <span class="op">=</span> black_housing_values[black_housing_values <span class="op">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   Black households had positive median housing wealth in </span><span class="sc">{</span><span class="bu">len</span>(black_positive_years)<span class="sc">}</span><span class="ss"> of </span><span class="sc">{</span><span class="bu">len</span>(black_housing_values)<span class="sc">}</span><span class="ss"> years"</span>)</span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">2. HOMEOWNERSHIP RATES:"</span>)</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   White households:"</span>)</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"     1989: </span><span class="sc">{</span>homeownership_pivot<span class="sc">.</span>loc[<span class="dv">1989</span>, <span class="st">'white'</span>]<span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"     2016: </span><span class="sc">{</span>homeownership_pivot<span class="sc">.</span>loc[<span class="dv">2016</span>, <span class="st">'white'</span>]<span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"     Average: </span><span class="sc">{</span>homeownership_pivot[<span class="st">'white'</span>]<span class="sc">.</span>mean()<span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   Black households:"</span>)</span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"     1989: </span><span class="sc">{</span>homeownership_pivot<span class="sc">.</span>loc[<span class="dv">1989</span>, <span class="st">'black'</span>]<span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"     2016: </span><span class="sc">{</span>homeownership_pivot<span class="sc">.</span>loc[<span class="dv">2016</span>, <span class="st">'black'</span>]<span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"     Average: </span><span class="sc">{</span>homeownership_pivot[<span class="st">'black'</span>]<span class="sc">.</span>mean()<span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Homeownership gap</span></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>homeownership_gap <span class="op">=</span> homeownership_pivot[<span class="st">'white'</span>] <span class="op">-</span> homeownership_pivot[<span class="st">'black'</span>]</span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">   Homeownership Gap (White - Black):"</span>)</span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"     1989: </span><span class="sc">{</span>homeownership_gap<span class="sc">.</span>loc[<span class="dv">1989</span>]<span class="sc">:.1f}</span><span class="ss"> percentage points"</span>)</span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"     2016: </span><span class="sc">{</span>homeownership_gap<span class="sc">.</span>loc[<span class="dv">2016</span>]<span class="sc">:.1f}</span><span class="ss"> percentage points"</span>)</span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"     Average: </span><span class="sc">{</span>homeownership_gap<span class="sc">.</span>mean()<span class="sc">:.1f}</span><span class="ss"> percentage points"</span>)</span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">3. MEDIAN HOUSING WEALTH AMONG HOMEOWNERS ONLY:"</span>)</span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   White homeowners:"</span>)</span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"     1989: $</span><span class="sc">{</span>homeowner_pivot<span class="sc">.</span>loc[<span class="dv">1989</span>, <span class="st">'white'</span>]<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"     2016: $</span><span class="sc">{</span>homeowner_pivot<span class="sc">.</span>loc[<span class="dv">2016</span>, <span class="st">'white'</span>]<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   Black homeowners:"</span>)</span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"     1989: $</span><span class="sc">{</span>homeowner_pivot<span class="sc">.</span>loc[<span class="dv">1989</span>, <span class="st">'black'</span>]<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"     2016: $</span><span class="sc">{</span>homeowner_pivot<span class="sc">.</span>loc[<span class="dv">2016</span>, <span class="st">'black'</span>]<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate ratio among homeowners</span></span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a>homeowner_ratio_1989 <span class="op">=</span> homeowner_pivot.loc[<span class="dv">1989</span>, <span class="st">'white'</span>] <span class="op">/</span> homeowner_pivot.loc[<span class="dv">1989</span>, <span class="st">'black'</span>]</span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a>homeowner_ratio_2016 <span class="op">=</span> homeowner_pivot.loc[<span class="dv">2016</span>, <span class="st">'white'</span>] <span class="op">/</span> homeowner_pivot.loc[<span class="dv">2016</span>, <span class="st">'black'</span>]</span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">   White-to-Black Housing Wealth Ratio (among homeowners):"</span>)</span>
<span id="cb23-52"><a href="#cb23-52" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"     1989: </span><span class="sc">{</span>homeowner_ratio_1989<span class="sc">:.1f}</span><span class="ss">"</span>)</span>
<span id="cb23-53"><a href="#cb23-53" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"     2016: </span><span class="sc">{</span>homeowner_ratio_2016<span class="sc">:.1f}</span><span class="ss">"</span>)</span>
<span id="cb23-54"><a href="#cb23-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-55"><a href="#cb23-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Housing wealth volatility</span></span>
<span id="cb23-56"><a href="#cb23-56" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">4. HOUSING WEALTH VOLATILITY (Coefficient of Variation):"</span>)</span>
<span id="cb23-57"><a href="#cb23-57" aria-hidden="true" tabindex="-1"></a>white_housing_cv <span class="op">=</span> (housing_pivot[<span class="st">'white'</span>].std() <span class="op">/</span> housing_pivot[<span class="st">'white'</span>].mean()) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb23-58"><a href="#cb23-58" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   White households: </span><span class="sc">{</span>white_housing_cv<span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb23-59"><a href="#cb23-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-60"><a href="#cb23-60" aria-hidden="true" tabindex="-1"></a><span class="co"># For Black households, calculate CV among homeowners since median is often 0</span></span>
<span id="cb23-61"><a href="#cb23-61" aria-hidden="true" tabindex="-1"></a>black_homeowner_cv <span class="op">=</span> (homeowner_pivot[<span class="st">'black'</span>].std() <span class="op">/</span> homeowner_pivot[<span class="st">'black'</span>].mean()) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb23-62"><a href="#cb23-62" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   Black homeowners: </span><span class="sc">{</span>black_homeowner_cv<span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb23-63"><a href="#cb23-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-64"><a href="#cb23-64" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">=== END HOUSING WEALTH ANALYSIS ==="</span>)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== HOUSING WEALTH ANALYSIS: BLACK vs WHITE HOUSEHOLDS ===

1. MEDIAN HOUSING WEALTH AMONG ALL HOUSEHOLDS:
   White households (1989): $93,293
   White households (2016): $130,000
   Black households (1989): $0
   Black households (2016): $0

   White Housing Wealth CAGR: 1.24% per year
   Black households had positive median housing wealth in 1 of 10 years

2. HOMEOWNERSHIP RATES:
   White households:
     1989: 70.5%
     2016: 71.9%
     Average: 72.8%
   Black households:
     1989: 42.2%
     2016: 44.0%
     Average: 45.6%

   Homeownership Gap (White - Black):
     1989: 28.3 percentage points
     2016: 27.9 percentage points
     Average: 27.2 percentage points

3. MEDIAN HOUSING WEALTH AMONG HOMEOWNERS ONLY:
   White homeowners:
     1989: $139,940
     2016: $200,000
   Black homeowners:
     1989: $83,964
     2016: $125,000

   White-to-Black Housing Wealth Ratio (among homeowners):
     1989: 1.7
     2016: 1.6

4. HOUSING WEALTH VOLATILITY (Coefficient of Variation):
   White households: 19.8%
   Black homeowners: 25.7%

=== END HOUSING WEALTH ANALYSIS ===</code></pre>
</div>
</div>
<div id="ec54d878" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># HOMEOWNERS AGED 25+ ANALYSIS: Housing vs Non-Housing Wealth</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"=== HOMEOWNERS AGED 25+ WEALTH ANALYSIS ===</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter to homeowners aged 25 or older (those with housing assets &gt; 0 and age &gt;= 25)</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>homeowners_25plus <span class="op">=</span> df[(df[<span class="st">'asset_housing'</span>] <span class="op">&gt;</span> <span class="dv">0</span>) <span class="op">&amp;</span> (df[<span class="st">'age'</span>] <span class="op">&gt;=</span> <span class="dv">25</span>)].copy()</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Filtered dataset: </span><span class="sc">{</span><span class="bu">len</span>(homeowners_25plus)<span class="sc">:,}</span><span class="ss"> homeowners aged 25+ out of </span><span class="sc">{</span><span class="bu">len</span>(df)<span class="sc">:,}</span><span class="ss"> total observations"</span>)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Represents </span><span class="sc">{</span><span class="bu">len</span>(homeowners_25plus)<span class="op">/</span><span class="bu">len</span>(df)<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">% of the full dataset"</span>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create non-housing wealth variable</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>homeowners_25plus[<span class="st">'non_housing_wealth'</span>] <span class="op">=</span> homeowners_25plus[<span class="st">'asset_total'</span>] <span class="op">-</span> homeowners_25plus[<span class="st">'asset_housing'</span>] <span class="op">-</span> homeowners_25plus[<span class="st">'debt_total'</span>] <span class="op">+</span> homeowners_25plus[<span class="st">'debt_housing'</span>]</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Race distribution among homeowners 25+:"</span>)</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>race_dist <span class="op">=</span> homeowners_25plus.groupby(<span class="st">'race'</span>).size().sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> race, count <span class="kw">in</span> race_dist.items():</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    pct <span class="op">=</span> (count <span class="op">/</span> <span class="bu">len</span>(homeowners_25plus)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"  </span><span class="sc">{</span>race<span class="sc">.</span>title()<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>count<span class="sc">:,}</span><span class="ss"> (</span><span class="sc">{</span>pct<span class="sc">:.1f}</span><span class="ss">%)"</span>)</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Focus on Black and White homeowners for detailed analysis</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>target_races <span class="op">=</span> [<span class="st">'black'</span>, <span class="st">'white'</span>]</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>bw_homeowners <span class="op">=</span> homeowners_25plus[homeowners_25plus[<span class="st">'race'</span>].isin(target_races)].copy()</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Black and White homeowners 25+: </span><span class="sc">{</span><span class="bu">len</span>(bw_homeowners)<span class="sc">:,}</span><span class="ss"> observations"</span>)</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate median housing and non-housing wealth by race and year</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>housing_nonhousing_data <span class="op">=</span> []</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> year <span class="kw">in</span> <span class="bu">sorted</span>(bw_homeowners[<span class="st">'year'</span>].unique()):</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> race <span class="kw">in</span> target_races:</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>        subset <span class="op">=</span> bw_homeowners[(bw_homeowners[<span class="st">'year'</span>] <span class="op">==</span> year) <span class="op">&amp;</span> (bw_homeowners[<span class="st">'race'</span>] <span class="op">==</span> race)]</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(subset) <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Housing wealth</span></span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>            housing_wealth_med <span class="op">=</span> weighted_median(subset[<span class="st">'asset_housing'</span>].values, subset[<span class="st">'weight'</span>].values)</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Non-housing wealth</span></span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>            nonhousing_wealth_med <span class="op">=</span> weighted_median(subset[<span class="st">'non_housing_wealth'</span>].values, subset[<span class="st">'weight'</span>].values)</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>            housing_nonhousing_data.append({</span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>                <span class="st">'year'</span>: year,</span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>                <span class="st">'race'</span>: race,</span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>                <span class="st">'median_housing_wealth'</span>: housing_wealth_med,</span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>                <span class="st">'median_nonhousing_wealth'</span>: nonhousing_wealth_med,</span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>                <span class="st">'sample_size'</span>: <span class="bu">len</span>(subset)</span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>hn_df <span class="op">=</span> pd.DataFrame(housing_nonhousing_data)</span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Create pivot tables</span></span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>housing_pivot_owners <span class="op">=</span> hn_df.pivot(index<span class="op">=</span><span class="st">'year'</span>, columns<span class="op">=</span><span class="st">'race'</span>, values<span class="op">=</span><span class="st">'median_housing_wealth'</span>)</span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a>nonhousing_pivot_owners <span class="op">=</span> hn_df.pivot(index<span class="op">=</span><span class="st">'year'</span>, columns<span class="op">=</span><span class="st">'race'</span>, values<span class="op">=</span><span class="st">'median_nonhousing_wealth'</span>)</span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">1. MEDIAN HOUSING WEALTH AMONG HOMEOWNERS 25+ (by race and year):"</span>)</span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(housing_pivot_owners.<span class="bu">round</span>(<span class="dv">0</span>))</span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">2. MEDIAN NON-HOUSING WEALTH AMONG HOMEOWNERS 25+ (by race and year):"</span>)</span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(nonhousing_pivot_owners.<span class="bu">round</span>(<span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== HOMEOWNERS AGED 25+ WEALTH ANALYSIS ===

Filtered dataset: 33,292 homeowners aged 25+ out of 47,776 total observations
Represents 69.7% of the full dataset

Race distribution among homeowners 25+:
  White: 28,370 (85.2%)
  Black: 2,105 (6.3%)
  Hispanic: 1,570 (4.7%)
  Other: 1,247 (3.7%)

Black and White homeowners 25+: 30,475 observations

1. MEDIAN HOUSING WEALTH AMONG HOMEOWNERS 25+ (by race and year):
race     black     white
year                    
1989   83964.0  139940.0
1992   80499.0  142551.0
1995   93960.0  144072.0
1998  103282.0  147546.0
2001  108388.0  176131.0
2004  130994.0  209844.0
2007  173702.0  231603.0
2010  132639.0  193433.0
2013  108266.0  185599.0
2016  125000.0  200000.0

2. MEDIAN NON-HOUSING WEALTH AMONG HOMEOWNERS 25+ (by race and year):
race    black     white
year                   
1989  12128.0   81725.0
1992  16603.0   70185.0
1995  20828.0   80179.0
1998  27517.0  113758.0
2001  32462.0  146053.0
2004  20984.0  121964.0
2007  40299.0  124371.0
2010  23720.0  110643.0
2013  18869.0  124764.0
2016  29540.0  144730.0</code></pre>
</div>
</div>
<div id="d7725e1d" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create comprehensive visualizations for homeowners 25+</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>fig, ((ax1, ax2), (ax3, ax4)) <span class="op">=</span> plt.subplots(<span class="dv">2</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">16</span>, <span class="dv">12</span>))</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 1: Housing wealth trends for homeowners 25+</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>colors_race <span class="op">=</span> [<span class="st">'#1f77b4'</span>, <span class="st">'#ff7f0e'</span>]  <span class="co"># Blue for White, Orange for Black</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, race <span class="kw">in</span> <span class="bu">enumerate</span>([<span class="st">'white'</span>, <span class="st">'black'</span>]):</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> race <span class="kw">in</span> housing_pivot_owners.columns:</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>        ax1.plot(housing_pivot_owners.index, housing_pivot_owners[race], marker<span class="op">=</span><span class="st">'o'</span>, linewidth<span class="op">=</span><span class="dv">3</span>, </span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>                label<span class="op">=</span><span class="ss">f'</span><span class="sc">{</span>race<span class="sc">.</span>title()<span class="sc">}</span><span class="ss"> Homeowners'</span>, color<span class="op">=</span>colors_race[i], markersize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">'Median Housing Wealth: Black vs White Homeowners 25+</span><span class="ch">\n</span><span class="st">(1989-2016)'</span>, </span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>ax1.set_xlabel(<span class="st">'Year'</span>)</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>ax1.set_ylabel(<span class="st">'Median Housing Wealth ($)'</span>)</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>ax1.legend()</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>ax1.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>ax1.yaxis.set_major_formatter(plt.FuncFormatter(<span class="kw">lambda</span> x, p: <span class="ss">f'$</span><span class="sc">{</span>x<span class="sc">:,.0f}</span><span class="ss">'</span>))</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 2: Non-housing wealth trends for homeowners 25+</span></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, race <span class="kw">in</span> <span class="bu">enumerate</span>([<span class="st">'white'</span>, <span class="st">'black'</span>]):</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> race <span class="kw">in</span> nonhousing_pivot_owners.columns:</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>        ax2.plot(nonhousing_pivot_owners.index, nonhousing_pivot_owners[race], marker<span class="op">=</span><span class="st">'s'</span>, linewidth<span class="op">=</span><span class="dv">3</span>, </span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>                label<span class="op">=</span><span class="ss">f'</span><span class="sc">{</span>race<span class="sc">.</span>title()<span class="sc">}</span><span class="ss"> Homeowners'</span>, color<span class="op">=</span>colors_race[i], markersize<span class="op">=</span><span class="dv">8</span>)</span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">'Median Non-Housing Wealth: Black vs White Homeowners 25+</span><span class="ch">\n</span><span class="st">(1989-2016)'</span>, </span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>ax2.set_xlabel(<span class="st">'Year'</span>)</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>ax2.set_ylabel(<span class="st">'Median Non-Housing Wealth ($)'</span>)</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>ax2.legend()</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>ax2.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>ax2.yaxis.set_major_formatter(plt.FuncFormatter(<span class="kw">lambda</span> x, p: <span class="ss">f'$</span><span class="sc">{</span>x<span class="sc">:,.0f}</span><span class="ss">'</span>))</span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 3: Housing wealth gap between races</span></span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>housing_gap_owners <span class="op">=</span> housing_pivot_owners[<span class="st">'white'</span>] <span class="op">-</span> housing_pivot_owners[<span class="st">'black'</span>]</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>ax3.fill_between(housing_gap_owners.index, <span class="dv">0</span>, housing_gap_owners.values, alpha<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span><span class="st">'red'</span>)</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a>ax3.plot(housing_gap_owners.index, housing_gap_owners.values, marker<span class="op">=</span><span class="st">'o'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, </span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>         color<span class="op">=</span><span class="st">'darkred'</span>, markersize<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>ax3.set_title(<span class="st">'Housing Wealth Gap Among Homeowners 25+</span><span class="ch">\n</span><span class="st">(White - Black)'</span>, </span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>ax3.set_xlabel(<span class="st">'Year'</span>)</span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>ax3.set_ylabel(<span class="st">'Housing Wealth Gap ($)'</span>)</span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>ax3.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>ax3.yaxis.set_major_formatter(plt.FuncFormatter(<span class="kw">lambda</span> x, p: <span class="ss">f'$</span><span class="sc">{</span>x<span class="sc">:,.0f}</span><span class="ss">'</span>))</span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot 4: Non-housing wealth gap between races</span></span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a>nonhousing_gap_owners <span class="op">=</span> nonhousing_pivot_owners[<span class="st">'white'</span>] <span class="op">-</span> nonhousing_pivot_owners[<span class="st">'black'</span>]</span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a>ax4.fill_between(nonhousing_gap_owners.index, <span class="dv">0</span>, nonhousing_gap_owners.values, alpha<span class="op">=</span><span class="fl">0.6</span>, color<span class="op">=</span><span class="st">'purple'</span>)</span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a>ax4.plot(nonhousing_gap_owners.index, nonhousing_gap_owners.values, marker<span class="op">=</span><span class="st">'s'</span>, linewidth<span class="op">=</span><span class="dv">2</span>, </span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a>         color<span class="op">=</span><span class="st">'darkviolet'</span>, markersize<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a>ax4.set_title(<span class="st">'Non-Housing Wealth Gap Among Homeowners 25+</span><span class="ch">\n</span><span class="st">(White - Black)'</span>, </span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a>              fontsize<span class="op">=</span><span class="dv">14</span>, fontweight<span class="op">=</span><span class="st">'bold'</span>)</span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true" tabindex="-1"></a>ax4.set_xlabel(<span class="st">'Year'</span>)</span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true" tabindex="-1"></a>ax4.set_ylabel(<span class="st">'Non-Housing Wealth Gap ($)'</span>)</span>
<span id="cb27-54"><a href="#cb27-54" aria-hidden="true" tabindex="-1"></a>ax4.grid(<span class="va">True</span>, alpha<span class="op">=</span><span class="fl">0.3</span>)</span>
<span id="cb27-55"><a href="#cb27-55" aria-hidden="true" tabindex="-1"></a>ax4.yaxis.set_major_formatter(plt.FuncFormatter(<span class="kw">lambda</span> x, p: <span class="ss">f'$</span><span class="sc">{</span>x<span class="sc">:,.0f}</span><span class="ss">'</span>))</span>
<span id="cb27-56"><a href="#cb27-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-57"><a href="#cb27-57" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb27-58"><a href="#cb27-58" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb27-59"><a href="#cb27-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-60"><a href="#cb27-60" aria-hidden="true" tabindex="-1"></a><span class="co"># FINANCIAL CRISIS ANALYSIS (2007 as base period)</span></span>
<span id="cb27-61"><a href="#cb27-61" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">=== FINANCIAL CRISIS IMPACT ANALYSIS (2007 Base) ===</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb27-62"><a href="#cb27-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-63"><a href="#cb27-63" aria-hidden="true" tabindex="-1"></a><span class="co"># Get 2007 and 2010 values for comparison</span></span>
<span id="cb27-64"><a href="#cb27-64" aria-hidden="true" tabindex="-1"></a>crisis_years <span class="op">=</span> [<span class="dv">2007</span>, <span class="dv">2010</span>]</span>
<span id="cb27-65"><a href="#cb27-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-66"><a href="#cb27-66" aria-hidden="true" tabindex="-1"></a><span class="co"># Housing wealth losses</span></span>
<span id="cb27-67"><a href="#cb27-67" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"3. HOUSING WEALTH LOSSES (2007-2010):"</span>)</span>
<span id="cb27-68"><a href="#cb27-68" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> race <span class="kw">in</span> [<span class="st">'white'</span>, <span class="st">'black'</span>]:</span>
<span id="cb27-69"><a href="#cb27-69" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> race <span class="kw">in</span> housing_pivot_owners.columns:</span>
<span id="cb27-70"><a href="#cb27-70" aria-hidden="true" tabindex="-1"></a>        housing_2007 <span class="op">=</span> housing_pivot_owners.loc[<span class="dv">2007</span>, race]</span>
<span id="cb27-71"><a href="#cb27-71" aria-hidden="true" tabindex="-1"></a>        housing_2010 <span class="op">=</span> housing_pivot_owners.loc[<span class="dv">2010</span>, race]</span>
<span id="cb27-72"><a href="#cb27-72" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb27-73"><a href="#cb27-73" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Dollar loss</span></span>
<span id="cb27-74"><a href="#cb27-74" aria-hidden="true" tabindex="-1"></a>        dollar_loss <span class="op">=</span> housing_2007 <span class="op">-</span> housing_2010</span>
<span id="cb27-75"><a href="#cb27-75" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb27-76"><a href="#cb27-76" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Proportional loss</span></span>
<span id="cb27-77"><a href="#cb27-77" aria-hidden="true" tabindex="-1"></a>        prop_loss <span class="op">=</span> (dollar_loss <span class="op">/</span> housing_2007) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb27-78"><a href="#cb27-78" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb27-79"><a href="#cb27-79" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"   </span><span class="sc">{</span>race<span class="sc">.</span>title()<span class="sc">}</span><span class="ss"> homeowners 25+:"</span>)</span>
<span id="cb27-80"><a href="#cb27-80" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"     2007: $</span><span class="sc">{</span>housing_2007<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb27-81"><a href="#cb27-81" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"     2010: $</span><span class="sc">{</span>housing_2010<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb27-82"><a href="#cb27-82" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"     Dollar loss: $</span><span class="sc">{</span>dollar_loss<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb27-83"><a href="#cb27-83" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"     Proportional loss: </span><span class="sc">{</span>prop_loss<span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb27-84"><a href="#cb27-84" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>()</span>
<span id="cb27-85"><a href="#cb27-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-86"><a href="#cb27-86" aria-hidden="true" tabindex="-1"></a><span class="co"># Non-housing wealth changes</span></span>
<span id="cb27-87"><a href="#cb27-87" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"4. NON-HOUSING WEALTH CHANGES (2007-2010):"</span>)</span>
<span id="cb27-88"><a href="#cb27-88" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> race <span class="kw">in</span> [<span class="st">'white'</span>, <span class="st">'black'</span>]:</span>
<span id="cb27-89"><a href="#cb27-89" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> race <span class="kw">in</span> nonhousing_pivot_owners.columns:</span>
<span id="cb27-90"><a href="#cb27-90" aria-hidden="true" tabindex="-1"></a>        nonhousing_2007 <span class="op">=</span> nonhousing_pivot_owners.loc[<span class="dv">2007</span>, race]</span>
<span id="cb27-91"><a href="#cb27-91" aria-hidden="true" tabindex="-1"></a>        nonhousing_2010 <span class="op">=</span> nonhousing_pivot_owners.loc[<span class="dv">2010</span>, race]</span>
<span id="cb27-92"><a href="#cb27-92" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb27-93"><a href="#cb27-93" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Dollar change</span></span>
<span id="cb27-94"><a href="#cb27-94" aria-hidden="true" tabindex="-1"></a>        dollar_change <span class="op">=</span> nonhousing_2010 <span class="op">-</span> nonhousing_2007</span>
<span id="cb27-95"><a href="#cb27-95" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb27-96"><a href="#cb27-96" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Proportional change (handle negative values carefully)</span></span>
<span id="cb27-97"><a href="#cb27-97" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> nonhousing_2007 <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb27-98"><a href="#cb27-98" aria-hidden="true" tabindex="-1"></a>            prop_change <span class="op">=</span> (dollar_change <span class="op">/</span> <span class="bu">abs</span>(nonhousing_2007)) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb27-99"><a href="#cb27-99" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb27-100"><a href="#cb27-100" aria-hidden="true" tabindex="-1"></a>            prop_change <span class="op">=</span> np.nan</span>
<span id="cb27-101"><a href="#cb27-101" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb27-102"><a href="#cb27-102" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"   </span><span class="sc">{</span>race<span class="sc">.</span>title()<span class="sc">}</span><span class="ss"> homeowners 25+:"</span>)</span>
<span id="cb27-103"><a href="#cb27-103" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"     2007: $</span><span class="sc">{</span>nonhousing_2007<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb27-104"><a href="#cb27-104" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"     2010: $</span><span class="sc">{</span>nonhousing_2010<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb27-105"><a href="#cb27-105" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"     Dollar change: $</span><span class="sc">{</span>dollar_change<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb27-106"><a href="#cb27-106" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> np.isnan(prop_change):</span>
<span id="cb27-107"><a href="#cb27-107" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"     Proportional change: </span><span class="sc">{</span>prop_change<span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb27-108"><a href="#cb27-108" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb27-109"><a href="#cb27-109" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"     Proportional change: N/A (zero base)"</span>)</span>
<span id="cb27-110"><a href="#cb27-110" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>()</span>
<span id="cb27-111"><a href="#cb27-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-112"><a href="#cb27-112" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary comparison</span></span>
<span id="cb27-113"><a href="#cb27-113" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"5. CRISIS IMPACT SUMMARY:"</span>)</span>
<span id="cb27-114"><a href="#cb27-114" aria-hidden="true" tabindex="-1"></a>white_housing_loss <span class="op">=</span> housing_pivot_owners.loc[<span class="dv">2007</span>, <span class="st">'white'</span>] <span class="op">-</span> housing_pivot_owners.loc[<span class="dv">2010</span>, <span class="st">'white'</span>]</span>
<span id="cb27-115"><a href="#cb27-115" aria-hidden="true" tabindex="-1"></a>black_housing_loss <span class="op">=</span> housing_pivot_owners.loc[<span class="dv">2007</span>, <span class="st">'black'</span>] <span class="op">-</span> housing_pivot_owners.loc[<span class="dv">2010</span>, <span class="st">'black'</span>]</span>
<span id="cb27-116"><a href="#cb27-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-117"><a href="#cb27-117" aria-hidden="true" tabindex="-1"></a>white_housing_prop_loss <span class="op">=</span> (white_housing_loss <span class="op">/</span> housing_pivot_owners.loc[<span class="dv">2007</span>, <span class="st">'white'</span>]) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb27-118"><a href="#cb27-118" aria-hidden="true" tabindex="-1"></a>black_housing_prop_loss <span class="op">=</span> (black_housing_loss <span class="op">/</span> housing_pivot_owners.loc[<span class="dv">2007</span>, <span class="st">'black'</span>]) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb27-119"><a href="#cb27-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-120"><a href="#cb27-120" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"   Largest housing wealth loss in DOLLAR terms:"</span>)</span>
<span id="cb27-121"><a href="#cb27-121" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> white_housing_loss <span class="op">&gt;</span> black_housing_loss:</span>
<span id="cb27-122"><a href="#cb27-122" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"     WHITE homeowners: $</span><span class="sc">{</span>white_housing_loss<span class="sc">:,.0f}</span><span class="ss"> loss"</span>)</span>
<span id="cb27-123"><a href="#cb27-123" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"     vs Black homeowners: $</span><span class="sc">{</span>black_housing_loss<span class="sc">:,.0f}</span><span class="ss"> loss"</span>)</span>
<span id="cb27-124"><a href="#cb27-124" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"     White homeowners lost $</span><span class="sc">{</span>white_housing_loss <span class="op">-</span> black_housing_loss<span class="sc">:,.0f}</span><span class="ss"> more"</span>)</span>
<span id="cb27-125"><a href="#cb27-125" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb27-126"><a href="#cb27-126" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"     BLACK homeowners: $</span><span class="sc">{</span>black_housing_loss<span class="sc">:,.0f}</span><span class="ss"> loss"</span>)</span>
<span id="cb27-127"><a href="#cb27-127" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"     vs White homeowners: $</span><span class="sc">{</span>white_housing_loss<span class="sc">:,.0f}</span><span class="ss"> loss"</span>)</span>
<span id="cb27-128"><a href="#cb27-128" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"     Black homeowners lost $</span><span class="sc">{</span>black_housing_loss <span class="op">-</span> white_housing_loss<span class="sc">:,.0f}</span><span class="ss"> more"</span>)</span>
<span id="cb27-129"><a href="#cb27-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-130"><a href="#cb27-130" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">   Largest housing wealth loss in PROPORTIONAL terms:"</span>)</span>
<span id="cb27-131"><a href="#cb27-131" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> white_housing_prop_loss <span class="op">&gt;</span> black_housing_prop_loss:</span>
<span id="cb27-132"><a href="#cb27-132" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"     WHITE homeowners: </span><span class="sc">{</span>white_housing_prop_loss<span class="sc">:.1f}</span><span class="ss">% loss"</span>)</span>
<span id="cb27-133"><a href="#cb27-133" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"     vs Black homeowners: </span><span class="sc">{</span>black_housing_prop_loss<span class="sc">:.1f}</span><span class="ss">% loss"</span>)</span>
<span id="cb27-134"><a href="#cb27-134" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"     White homeowners lost </span><span class="sc">{</span>white_housing_prop_loss <span class="op">-</span> black_housing_prop_loss<span class="sc">:.1f}</span><span class="ss"> percentage points more"</span>)</span>
<span id="cb27-135"><a href="#cb27-135" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb27-136"><a href="#cb27-136" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"     BLACK homeowners: </span><span class="sc">{</span>black_housing_prop_loss<span class="sc">:.1f}</span><span class="ss">% loss"</span>)</span>
<span id="cb27-137"><a href="#cb27-137" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"     vs White homeowners: </span><span class="sc">{</span>white_housing_prop_loss<span class="sc">:.1f}</span><span class="ss">% loss"</span>)</span>
<span id="cb27-138"><a href="#cb27-138" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"     Black homeowners lost </span><span class="sc">{</span>black_housing_prop_loss <span class="op">-</span> white_housing_prop_loss<span class="sc">:.1f}</span><span class="ss"> percentage points more"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="main_files/figure-html/cell-17-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
=== FINANCIAL CRISIS IMPACT ANALYSIS (2007 Base) ===

3. HOUSING WEALTH LOSSES (2007-2010):
   White homeowners 25+:
     2007: $231,603
     2010: $193,433
     Dollar loss: $38,170
     Proportional loss: 16.5%

   Black homeowners 25+:
     2007: $173,702
     2010: $132,639
     Dollar loss: $41,063
     Proportional loss: 23.6%

4. NON-HOUSING WEALTH CHANGES (2007-2010):
   White homeowners 25+:
     2007: $124,371
     2010: $110,643
     Dollar change: $-13,727
     Proportional change: -11.0%

   Black homeowners 25+:
     2007: $40,299
     2010: $23,720
     Dollar change: $-16,579
     Proportional change: -41.1%

5. CRISIS IMPACT SUMMARY:
   Largest housing wealth loss in DOLLAR terms:
     BLACK homeowners: $41,063 loss
     vs White homeowners: $38,170 loss
     Black homeowners lost $2,892 more

   Largest housing wealth loss in PROPORTIONAL terms:
     BLACK homeowners: 23.6% loss
     vs White homeowners: 16.5% loss
     Black homeowners lost 7.2 percentage points more</code></pre>
</div>
</div>
<div id="2ad70e6c" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># COMPREHENSIVE TREND ANALYSIS FOR HOMEOWNERS 25+</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"=== COMPREHENSIVE TREND ANALYSIS: HOMEOWNERS 25+ ===</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate growth rates for the full period</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>years_span <span class="op">=</span> <span class="dv">2016</span> <span class="op">-</span> <span class="dv">1989</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Housing wealth growth</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"6. LONG-TERM GROWTH RATES (1989-2016):"</span>)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   Housing Wealth:"</span>)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> race <span class="kw">in</span> [<span class="st">'white'</span>, <span class="st">'black'</span>]:</span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> race <span class="kw">in</span> housing_pivot_owners.columns:</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>        start_val <span class="op">=</span> housing_pivot_owners.loc[<span class="dv">1989</span>, race]</span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a>        end_val <span class="op">=</span> housing_pivot_owners.loc[<span class="dv">2016</span>, race]</span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>        cagr <span class="op">=</span> calculate_cagr(start_val, end_val, years_span)</span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>        total_growth <span class="op">=</span> ((end_val <span class="op">-</span> start_val) <span class="op">/</span> start_val) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"     </span><span class="sc">{</span>race<span class="sc">.</span>title()<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>cagr<span class="sc">:.2f}</span><span class="ss">% CAGR, </span><span class="sc">{</span>total_growth<span class="sc">:.1f}</span><span class="ss">% total growth"</span>)</span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">   Non-Housing Wealth:"</span>)</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> race <span class="kw">in</span> [<span class="st">'white'</span>, <span class="st">'black'</span>]:</span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> race <span class="kw">in</span> nonhousing_pivot_owners.columns:</span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>        start_val <span class="op">=</span> nonhousing_pivot_owners.loc[<span class="dv">1989</span>, race]</span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a>        end_val <span class="op">=</span> nonhousing_pivot_owners.loc[<span class="dv">2016</span>, race]</span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Handle negative values more carefully</span></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> start_val <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">and</span> end_val <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a>            cagr <span class="op">=</span> calculate_cagr(start_val, end_val, years_span)</span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>            total_growth <span class="op">=</span> ((end_val <span class="op">-</span> start_val) <span class="op">/</span> start_val) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"     </span><span class="sc">{</span>race<span class="sc">.</span>title()<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>cagr<span class="sc">:.2f}</span><span class="ss">% CAGR, </span><span class="sc">{</span>total_growth<span class="sc">:.1f}</span><span class="ss">% total growth"</span>)</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>            dollar_change <span class="op">=</span> end_val <span class="op">-</span> start_val</span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"     </span><span class="sc">{</span>race<span class="sc">.</span>title()<span class="sc">}</span><span class="ss">: $</span><span class="sc">{</span>dollar_change<span class="sc">:,.0f}</span><span class="ss"> absolute change (negative base values)"</span>)</span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Wealth composition analysis</span></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">7. WEALTH COMPOSITION ANALYSIS:"</span>)</span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   1989 - Housing vs Non-Housing Wealth Ratios:"</span>)</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> race <span class="kw">in</span> [<span class="st">'white'</span>, <span class="st">'black'</span>]:</span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>    housing_1989 <span class="op">=</span> housing_pivot_owners.loc[<span class="dv">1989</span>, race]</span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>    nonhousing_1989 <span class="op">=</span> nonhousing_pivot_owners.loc[<span class="dv">1989</span>, race]</span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a>    total_1989 <span class="op">=</span> housing_1989 <span class="op">+</span> nonhousing_1989</span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>    housing_pct <span class="op">=</span> (housing_1989 <span class="op">/</span> total_1989) <span class="op">*</span> <span class="dv">100</span> <span class="cf">if</span> total_1989 <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a>    nonhousing_pct <span class="op">=</span> (nonhousing_1989 <span class="op">/</span> total_1989) <span class="op">*</span> <span class="dv">100</span> <span class="cf">if</span> total_1989 <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"     </span><span class="sc">{</span>race<span class="sc">.</span>title()<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>housing_pct<span class="sc">:.1f}</span><span class="ss">% housing, </span><span class="sc">{</span>nonhousing_pct<span class="sc">:.1f}</span><span class="ss">% non-housing"</span>)</span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">   2016 - Housing vs Non-Housing Wealth Ratios:"</span>)</span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> race <span class="kw">in</span> [<span class="st">'white'</span>, <span class="st">'black'</span>]:</span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>    housing_2016 <span class="op">=</span> housing_pivot_owners.loc[<span class="dv">2016</span>, race]</span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a>    nonhousing_2016 <span class="op">=</span> nonhousing_pivot_owners.loc[<span class="dv">2016</span>, race]</span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a>    total_2016 <span class="op">=</span> housing_2016 <span class="op">+</span> nonhousing_2016</span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a>    housing_pct <span class="op">=</span> (housing_2016 <span class="op">/</span> total_2016) <span class="op">*</span> <span class="dv">100</span> <span class="cf">if</span> total_2016 <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a>    nonhousing_pct <span class="op">=</span> (nonhousing_2016 <span class="op">/</span> total_2016) <span class="op">*</span> <span class="dv">100</span> <span class="cf">if</span> total_2016 <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="dv">0</span></span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"     </span><span class="sc">{</span>race<span class="sc">.</span>title()<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>housing_pct<span class="sc">:.1f}</span><span class="ss">% housing, </span><span class="sc">{</span>nonhousing_pct<span class="sc">:.1f}</span><span class="ss">% non-housing"</span>)</span>
<span id="cb29-56"><a href="#cb29-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-57"><a href="#cb29-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Pre-crisis vs post-crisis comparison</span></span>
<span id="cb29-58"><a href="#cb29-58" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">8. PRE-CRISIS vs POST-CRISIS COMPARISON:"</span>)</span>
<span id="cb29-59"><a href="#cb29-59" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   Pre-Crisis Peak (2007) vs 2016 Recovery:"</span>)</span>
<span id="cb29-60"><a href="#cb29-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-61"><a href="#cb29-61" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> wealth_type, pivot_table <span class="kw">in</span> [(<span class="st">'Housing'</span>, housing_pivot_owners), (<span class="st">'Non-Housing'</span>, nonhousing_pivot_owners)]:</span>
<span id="cb29-62"><a href="#cb29-62" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">   </span><span class="sc">{</span>wealth_type<span class="sc">}</span><span class="ss"> Wealth Recovery:"</span>)</span>
<span id="cb29-63"><a href="#cb29-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> race <span class="kw">in</span> [<span class="st">'white'</span>, <span class="st">'black'</span>]:</span>
<span id="cb29-64"><a href="#cb29-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> race <span class="kw">in</span> pivot_table.columns:</span>
<span id="cb29-65"><a href="#cb29-65" aria-hidden="true" tabindex="-1"></a>            peak_2007 <span class="op">=</span> pivot_table.loc[<span class="dv">2007</span>, race]</span>
<span id="cb29-66"><a href="#cb29-66" aria-hidden="true" tabindex="-1"></a>            recovery_2016 <span class="op">=</span> pivot_table.loc[<span class="dv">2016</span>, race]</span>
<span id="cb29-67"><a href="#cb29-67" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb29-68"><a href="#cb29-68" aria-hidden="true" tabindex="-1"></a>            recovery_pct <span class="op">=</span> (recovery_2016 <span class="op">/</span> peak_2007) <span class="op">*</span> <span class="dv">100</span> <span class="cf">if</span> peak_2007 <span class="op">!=</span> <span class="dv">0</span> <span class="cf">else</span> np.nan</span>
<span id="cb29-69"><a href="#cb29-69" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb29-70"><a href="#cb29-70" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"     </span><span class="sc">{</span>race<span class="sc">.</span>title()<span class="sc">}</span><span class="ss">: 2007 = $</span><span class="sc">{</span>peak_2007<span class="sc">:,.0f}</span><span class="ss">, 2016 = $</span><span class="sc">{</span>recovery_2016<span class="sc">:,.0f}</span><span class="ss">"</span>)</span>
<span id="cb29-71"><a href="#cb29-71" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> np.isnan(recovery_pct):</span>
<span id="cb29-72"><a href="#cb29-72" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> recovery_pct <span class="op">&gt;=</span> <span class="dv">100</span>:</span>
<span id="cb29-73"><a href="#cb29-73" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"              ✓ FULL RECOVERY (</span><span class="sc">{</span>recovery_pct<span class="sc">:.1f}</span><span class="ss">% of 2007 peak)"</span>)</span>
<span id="cb29-74"><a href="#cb29-74" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb29-75"><a href="#cb29-75" aria-hidden="true" tabindex="-1"></a>                    <span class="bu">print</span>(<span class="ss">f"              ⚠ PARTIAL RECOVERY (</span><span class="sc">{</span>recovery_pct<span class="sc">:.1f}</span><span class="ss">% of 2007 peak)"</span>)</span>
<span id="cb29-76"><a href="#cb29-76" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb29-77"><a href="#cb29-77" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="ss">f"              Cannot calculate recovery ratio (zero/negative base)"</span>)</span>
<span id="cb29-78"><a href="#cb29-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-79"><a href="#cb29-79" aria-hidden="true" tabindex="-1"></a><span class="co"># Volatility comparison</span></span>
<span id="cb29-80"><a href="#cb29-80" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">9. WEALTH VOLATILITY COMPARISON (Coefficient of Variation):"</span>)</span>
<span id="cb29-81"><a href="#cb29-81" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"   Housing Wealth Volatility:"</span>)</span>
<span id="cb29-82"><a href="#cb29-82" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> race <span class="kw">in</span> [<span class="st">'white'</span>, <span class="st">'black'</span>]:</span>
<span id="cb29-83"><a href="#cb29-83" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> race <span class="kw">in</span> housing_pivot_owners.columns:</span>
<span id="cb29-84"><a href="#cb29-84" aria-hidden="true" tabindex="-1"></a>        cv <span class="op">=</span> (housing_pivot_owners[race].std() <span class="op">/</span> housing_pivot_owners[race].mean()) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb29-85"><a href="#cb29-85" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"     </span><span class="sc">{</span>race<span class="sc">.</span>title()<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>cv<span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb29-86"><a href="#cb29-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-87"><a href="#cb29-87" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">   Non-Housing Wealth Volatility:"</span>)</span>
<span id="cb29-88"><a href="#cb29-88" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> race <span class="kw">in</span> [<span class="st">'white'</span>, <span class="st">'black'</span>]:</span>
<span id="cb29-89"><a href="#cb29-89" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> race <span class="kw">in</span> nonhousing_pivot_owners.columns:</span>
<span id="cb29-90"><a href="#cb29-90" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Handle potential negative means</span></span>
<span id="cb29-91"><a href="#cb29-91" aria-hidden="true" tabindex="-1"></a>        mean_val <span class="op">=</span> nonhousing_pivot_owners[race].mean()</span>
<span id="cb29-92"><a href="#cb29-92" aria-hidden="true" tabindex="-1"></a>        std_val <span class="op">=</span> nonhousing_pivot_owners[race].std()</span>
<span id="cb29-93"><a href="#cb29-93" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> mean_val <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb29-94"><a href="#cb29-94" aria-hidden="true" tabindex="-1"></a>            cv <span class="op">=</span> (std_val <span class="op">/</span> mean_val) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb29-95"><a href="#cb29-95" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"     </span><span class="sc">{</span>race<span class="sc">.</span>title()<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>cv<span class="sc">:.1f}</span><span class="ss">%"</span>)</span>
<span id="cb29-96"><a href="#cb29-96" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb29-97"><a href="#cb29-97" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"     </span><span class="sc">{</span>race<span class="sc">.</span>title()<span class="sc">}</span><span class="ss">: Cannot calculate CV (negative/zero mean)"</span>)</span>
<span id="cb29-98"><a href="#cb29-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-99"><a href="#cb29-99" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">=== KEY FINDINGS SUMMARY ==="</span>)</span>
<span id="cb29-100"><a href="#cb29-100" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✓ Analysis completed for homeowners aged 25+ only"</span>)</span>
<span id="cb29-101"><a href="#cb29-101" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✓ Housing wealth losses during 2007-2010 crisis quantified"</span>)</span>
<span id="cb29-102"><a href="#cb29-102" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✓ Non-housing wealth trends analyzed separately"</span>)</span>
<span id="cb29-103"><a href="#cb29-103" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✓ Racial disparities examined in both dollar and proportional terms"</span>)</span>
<span id="cb29-104"><a href="#cb29-104" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"✓ Long-term growth patterns and recovery analyzed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== COMPREHENSIVE TREND ANALYSIS: HOMEOWNERS 25+ ===

6. LONG-TERM GROWTH RATES (1989-2016):
   Housing Wealth:
     White: 1.33% CAGR, 42.9% total growth
     Black: 1.48% CAGR, 48.9% total growth

   Non-Housing Wealth:
     White: 2.14% CAGR, 77.1% total growth
     Black: 3.35% CAGR, 143.6% total growth

7. WEALTH COMPOSITION ANALYSIS:
   1989 - Housing vs Non-Housing Wealth Ratios:
     White: 63.1% housing, 36.9% non-housing
     Black: 87.4% housing, 12.6% non-housing

   2016 - Housing vs Non-Housing Wealth Ratios:
     White: 58.0% housing, 42.0% non-housing
     Black: 80.9% housing, 19.1% non-housing

8. PRE-CRISIS vs POST-CRISIS COMPARISON:
   Pre-Crisis Peak (2007) vs 2016 Recovery:

   Housing Wealth Recovery:
     White: 2007 = $231,603, 2016 = $200,000
              ⚠ PARTIAL RECOVERY (86.4% of 2007 peak)
     Black: 2007 = $173,702, 2016 = $125,000
              ⚠ PARTIAL RECOVERY (72.0% of 2007 peak)

   Non-Housing Wealth Recovery:
     White: 2007 = $124,371, 2016 = $144,730
              ✓ FULL RECOVERY (116.4% of 2007 peak)
     Black: 2007 = $40,299, 2016 = $29,540
              ⚠ PARTIAL RECOVERY (73.3% of 2007 peak)

9. WEALTH VOLATILITY COMPARISON (Coefficient of Variation):
   Housing Wealth Volatility:
     White: 18.3%
     Black: 24.3%

   Non-Housing Wealth Volatility:
     White: 23.7%
     Black: 34.2%

=== KEY FINDINGS SUMMARY ===
✓ Analysis completed for homeowners aged 25+ only
✓ Housing wealth losses during 2007-2010 crisis quantified
✓ Non-housing wealth trends analyzed separately
✓ Racial disparities examined in both dollar and proportional terms
✓ Long-term growth patterns and recovery analyzed</code></pre>
</div>
</div>
<section id="summary-table-median-wealth-and-gaps-19892016" class="level3">
<h3 class="anchored" data-anchor-id="summary-table-median-wealth-and-gaps-19892016">Summary Table: Median Wealth and Gaps (1989–2016)</h3>
<p>The table below presents the actual values (fill in as available), percent change, and compound annual growth rates (CAGR) for each group. This format allows for direct comparison of both absolute and relative changes.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Metric</th>
<th style="text-align: left;">Group</th>
<th style="text-align: left;">1989 Value</th>
<th style="text-align: left;">2016 Value</th>
<th style="text-align: left;">% Change (1989–2016)</th>
<th style="text-align: left;">CAGR</th>
<th style="text-align: left;">Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Median Wealth</strong></td>
<td style="text-align: left;">White</td>
<td style="text-align: left;">$[fill]</td>
<td style="text-align: left;">$[fill]</td>
<td style="text-align: left;">[fill]%</td>
<td style="text-align: left;">0.57%</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Black</td>
<td style="text-align: left;">$[fill]</td>
<td style="text-align: left;">$[fill]</td>
<td style="text-align: left;">[fill]%</td>
<td style="text-align: left;">2.84%</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Hispanic</td>
<td style="text-align: left;">$[fill]</td>
<td style="text-align: left;">$[fill]</td>
<td style="text-align: left;">[fill]%</td>
<td style="text-align: left;">3.46%</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">$[fill]</td>
<td style="text-align: left;">$[fill]</td>
<td style="text-align: left;">[fill]%</td>
<td style="text-align: left;">2.97%</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">College Degree</td>
<td style="text-align: left;">$[fill]</td>
<td style="text-align: left;">$[fill]</td>
<td style="text-align: left;">[fill]%</td>
<td style="text-align: left;">0.63%</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Some College</td>
<td style="text-align: left;">$[fill]</td>
<td style="text-align: left;">$[fill]</td>
<td style="text-align: left;">[fill]%</td>
<td style="text-align: left;">-1.38%</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">No College</td>
<td style="text-align: left;">$[fill]</td>
<td style="text-align: left;">$[fill]</td>
<td style="text-align: left;">[fill]%</td>
<td style="text-align: left;">-0.75%</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Wealth Gap Ratio</strong></td>
<td style="text-align: left;">White-to-Black</td>
<td style="text-align: left;">24.0</td>
<td style="text-align: left;">13.1</td>
<td style="text-align: left;">-45.4%</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">Ratio shrank</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">College-to-No College</td>
<td style="text-align: left;">4.0</td>
<td style="text-align: left;">5.9</td>
<td style="text-align: left;">+47.5%</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">Ratio grew</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Wealth Volatility (CV)</strong></td>
<td style="text-align: left;">White</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">16.1%</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Black</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">40.4%</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Hispanic</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">40.8%</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">53.5%</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">College Degree</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">23.9%</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Some College</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">26.3%</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">No College</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">19.0%</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Financial Crisis Impact (2007-2010)</strong></td>
<td style="text-align: left;">White</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">-29.4%</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Black</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">-28.4%</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Hispanic</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">-48.1%</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">-57.7%</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">College Degree</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">-31.1%</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Some College</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">-45.0%</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">No College</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">-41.8%</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<ul>
<li>Fill in the actual values for 1989 and 2016 as available.</li>
<li>The % Change column is ((2016 Value - 1989 Value) / 1989 Value) × 100.</li>
<li>This format makes it easy to observe both the values and percent differences across groups.</li>
</ul>
<div id="90a4c0ad" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract actual 1989 and 2016 values for comprehensive summary table</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"=== WEALTH VALUES AND PERCENT CHANGES (1989-2016) ===</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get values from existing pivot tables - years are in index, groups in columns</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>race_1989 <span class="op">=</span> pivot_race.loc[<span class="dv">1989</span>].<span class="bu">round</span>(<span class="dv">0</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>race_2016 <span class="op">=</span> pivot_race.loc[<span class="dv">2016</span>].<span class="bu">round</span>(<span class="dv">0</span>)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>edu_1989 <span class="op">=</span> pivot_edu.loc[<span class="dv">1989</span>].<span class="bu">round</span>(<span class="dv">0</span>)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>edu_2016 <span class="op">=</span> pivot_edu.loc[<span class="dv">2016</span>].<span class="bu">round</span>(<span class="dv">0</span>)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate percent changes</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calc_pct_change(start, end):</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ((end <span class="op">-</span> start) <span class="op">/</span> start <span class="op">*</span> <span class="dv">100</span>).<span class="bu">round</span>(<span class="dv">1</span>)</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>race_pct_change <span class="op">=</span> calc_pct_change(race_1989, race_2016)</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>edu_pct_change <span class="op">=</span> calc_pct_change(edu_1989, edu_2016)</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"RACE GROUPS:"</span>)</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'Group'</span><span class="sc">:&lt;12}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'1989 Value'</span><span class="sc">:&lt;15}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'2016 Value'</span><span class="sc">:&lt;15}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'% Change'</span><span class="sc">:&lt;12}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'CAGR'</span><span class="sc">:&lt;8}</span><span class="ss">"</span>)</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">65</span>)</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>cagr_race <span class="op">=</span> {<span class="st">'white'</span>: <span class="fl">0.57</span>, <span class="st">'black'</span>: <span class="fl">2.84</span>, <span class="st">'Hispanic'</span>: <span class="fl">3.46</span>, <span class="st">'other'</span>: <span class="fl">2.97</span>}</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> race <span class="kw">in</span> race_1989.index:</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>    val_1989 <span class="op">=</span> <span class="ss">f"$</span><span class="sc">{</span>race_1989[race]<span class="sc">:,.0f}</span><span class="ss">"</span></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>    val_2016 <span class="op">=</span> <span class="ss">f"$</span><span class="sc">{</span>race_2016[race]<span class="sc">:,.0f}</span><span class="ss">"</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>    pct_chg <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>race_pct_change[race]<span class="sc">:+.1f}</span><span class="ss">%"</span></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>    cagr <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>cagr_race[race]<span class="sc">:+.2f}</span><span class="ss">%"</span></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>race<span class="sc">.</span>title()<span class="sc">:&lt;12}</span><span class="ss"> </span><span class="sc">{</span>val_1989<span class="sc">:&lt;15}</span><span class="ss"> </span><span class="sc">{</span>val_2016<span class="sc">:&lt;15}</span><span class="ss"> </span><span class="sc">{</span>pct_chg<span class="sc">:&lt;12}</span><span class="ss"> </span><span class="sc">{</span>cagr<span class="sc">:&lt;8}</span><span class="ss">"</span>)</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">EDUCATION GROUPS:"</span>)</span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span><span class="st">'Group'</span><span class="sc">:&lt;15}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'1989 Value'</span><span class="sc">:&lt;15}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'2016 Value'</span><span class="sc">:&lt;15}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'% Change'</span><span class="sc">:&lt;12}</span><span class="ss"> </span><span class="sc">{</span><span class="st">'CAGR'</span><span class="sc">:&lt;8}</span><span class="ss">"</span>)</span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span> <span class="op">*</span> <span class="dv">70</span>)</span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>cagr_edu <span class="op">=</span> {<span class="st">'college degree'</span>: <span class="fl">0.63</span>, <span class="st">'some college'</span>: <span class="op">-</span><span class="fl">1.38</span>, <span class="st">'no college'</span>: <span class="op">-</span><span class="fl">0.75</span>}</span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> edu <span class="kw">in</span> edu_1989.index:</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>    val_1989 <span class="op">=</span> <span class="ss">f"$</span><span class="sc">{</span>edu_1989[edu]<span class="sc">:,.0f}</span><span class="ss">"</span></span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>    val_2016 <span class="op">=</span> <span class="ss">f"$</span><span class="sc">{</span>edu_2016[edu]<span class="sc">:,.0f}</span><span class="ss">"</span></span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>    pct_chg <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>edu_pct_change[edu]<span class="sc">:+.1f}</span><span class="ss">%"</span></span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>    cagr <span class="op">=</span> <span class="ss">f"</span><span class="sc">{</span>cagr_edu[edu]<span class="sc">:+.2f}</span><span class="ss">%"</span></span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>edu<span class="sc">.</span>title()<span class="sc">:&lt;15}</span><span class="ss"> </span><span class="sc">{</span>val_1989<span class="sc">:&lt;15}</span><span class="ss"> </span><span class="sc">{</span>val_2016<span class="sc">:&lt;15}</span><span class="ss"> </span><span class="sc">{</span>pct_chg<span class="sc">:&lt;12}</span><span class="ss"> </span><span class="sc">{</span>cagr<span class="sc">:&lt;8}</span><span class="ss">"</span>)</span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">WEALTH GAP RATIOS:"</span>)</span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>white_black_pct_change <span class="op">=</span> ((white_black_2016 <span class="op">-</span> white_black_1989) <span class="op">/</span> white_black_1989 <span class="op">*</span> <span class="dv">100</span>)</span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>college_nocollege_pct_change <span class="op">=</span> ((college_no_college_2016 <span class="op">-</span> college_no_college_1989) <span class="op">/</span> college_no_college_1989 <span class="op">*</span> <span class="dv">100</span>)</span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"White-to-Black: </span><span class="sc">{</span>white_black_1989<span class="sc">:.1f}</span><span class="ss"> (1989) → </span><span class="sc">{</span>white_black_2016<span class="sc">:.1f}</span><span class="ss"> (2016) = </span><span class="sc">{</span>white_black_pct_change<span class="sc">:+.1f}</span><span class="ss">% change"</span>)</span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"College-to-No College: </span><span class="sc">{</span>college_no_college_1989<span class="sc">:.1f}</span><span class="ss"> (1989) → </span><span class="sc">{</span>college_no_college_2016<span class="sc">:.1f}</span><span class="ss"> (2016) = </span><span class="sc">{</span>college_nocollege_pct_change<span class="sc">:+.1f}</span><span class="ss">% change"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>=== WEALTH VALUES AND PERCENT CHANGES (1989-2016) ===

RACE GROUPS:
Group        1989 Value      2016 Value      % Change     CAGR    
-----------------------------------------------------------------
Hispanic     $10,710         $26,800         +150.2%      +3.46%  
Black        $8,583          $18,300         +113.2%      +2.84%  
Other        $68,234         $150,350        +120.3%      +2.97%  
White        $206,364        $240,350        +16.5%       +0.57%  

EDUCATION GROUPS:
Group           1989 Value      2016 Value      % Change     CAGR    
----------------------------------------------------------------------
College Degree  $346,490        $410,800        +18.6%       +0.63%  
No College      $85,699         $69,921         -18.4%       -0.75%  
Some College    $140,928        $96,905         -31.2%       -1.38%  

WEALTH GAP RATIOS:
White-to-Black: 24.0 (1989) → 13.1 (2016) = -45.4% change
College-to-No College: 4.0 (1989) → 5.9 (2016) = +45.3% change</code></pre>
</div>
</div>
</section>
<section id="comprehensive-wealth-analysis-summary-19892016" class="level3">
<h3 class="anchored" data-anchor-id="comprehensive-wealth-analysis-summary-19892016">Comprehensive Wealth Analysis Summary (1989–2016)</h3>
<p>This table presents the complete picture of wealth changes across racial and educational groups, showing both absolute values and percentage changes to observe trends and disparities.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Metric</th>
<th style="text-align: left;">Group</th>
<th style="text-align: left;">1989 Value</th>
<th style="text-align: left;">2016 Value</th>
<th style="text-align: left;">% Change (1989–2016)</th>
<th style="text-align: left;">CAGR</th>
<th style="text-align: left;">Additional Info</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><strong>Median Wealth</strong></td>
<td style="text-align: left;">White</td>
<td style="text-align: left;">$206,364</td>
<td style="text-align: left;">$240,350</td>
<td style="text-align: left;">+16.5%</td>
<td style="text-align: left;">+0.57%</td>
<td style="text-align: left;">Highest absolute wealth</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Black</td>
<td style="text-align: left;">$8,583</td>
<td style="text-align: left;">$18,300</td>
<td style="text-align: left;">+113.2%</td>
<td style="text-align: left;">+2.84%</td>
<td style="text-align: left;">Fastest growth rate</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Hispanic</td>
<td style="text-align: left;">$10,710</td>
<td style="text-align: left;">$26,800</td>
<td style="text-align: left;">+150.2%</td>
<td style="text-align: left;">+3.46%</td>
<td style="text-align: left;">Largest % increase</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">$68,234</td>
<td style="text-align: left;">$150,350</td>
<td style="text-align: left;">+120.3%</td>
<td style="text-align: left;">+2.97%</td>
<td style="text-align: left;">High volatility group</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">College Degree</td>
<td style="text-align: left;">$346,490</td>
<td style="text-align: left;">$410,800</td>
<td style="text-align: left;">+18.6%</td>
<td style="text-align: left;">+0.63%</td>
<td style="text-align: left;">Highest absolute wealth</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Some College</td>
<td style="text-align: left;">$140,928</td>
<td style="text-align: left;">$96,905</td>
<td style="text-align: left;">-31.2%</td>
<td style="text-align: left;">-1.38%</td>
<td style="text-align: left;">Significant decline</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">No College</td>
<td style="text-align: left;">$85,699</td>
<td style="text-align: left;">$69,921</td>
<td style="text-align: left;">-18.4%</td>
<td style="text-align: left;">-0.75%</td>
<td style="text-align: left;">Moderate decline</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Wealth Gap Ratios</strong></td>
<td style="text-align: left;">White-to-Black</td>
<td style="text-align: left;">24.0</td>
<td style="text-align: left;">13.1</td>
<td style="text-align: left;">-45.4%</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">Gap narrowed significantly</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">College-to-No College</td>
<td style="text-align: left;">4.0</td>
<td style="text-align: left;">5.9</td>
<td style="text-align: left;">+45.3%</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">Gap widened substantially</td>
</tr>
<tr class="even">
<td style="text-align: left;"><strong>Wealth Volatility (CV)</strong></td>
<td style="text-align: left;">White</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">16.1% (lowest)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Black</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">40.4% (high)</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Hispanic</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">40.8% (high)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">53.5% (highest)</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">College Degree</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">23.9% (moderate)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Some College</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">26.3% (moderate)</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">No College</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">19.0% (low)</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><strong>Financial Crisis Impact (2007-2010)</strong></td>
<td style="text-align: left;">White</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">-29.4%</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">Moderate decline</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Black</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">-28.4%</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">Similar to White</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Hispanic</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">-48.1%</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">Severe impact</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">-57.7%</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">Most severe impact</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">College Degree</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">-31.1%</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">Moderate decline</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Some College</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">-45.0%</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">Large decline</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">No College</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">-41.8%</td>
<td style="text-align: left;">—</td>
<td style="text-align: left;">Significant decline</td>
</tr>
</tbody>
</table>
<section id="key-observations" class="level4">
<h4 class="anchored" data-anchor-id="key-observations">Key Observations:</h4>
<p><strong>Race-Based Patterns:</strong> - <strong>Convergence</strong>: Despite persistent gaps, minority groups show much faster growth rates (2.84-3.46% CAGR) compared to White households (0.57%) - <strong>Absolute Gaps</strong>: While percentage growth favors minorities, absolute dollar gaps remain substantial - <strong>Crisis Resilience</strong>: White and Black households showed similar crisis impacts (~29%), while Hispanic and Other groups were hit much harder</p>
<p><strong>Education-Based Patterns:</strong> - <strong>Divergence</strong>: The education premium has grown significantly, with college graduates gaining wealth while non-college groups lost wealth - <strong>Declining Middle</strong>: The “some college” group experienced the steepest decline (-31.2%), suggesting a hollowing out of middle-skill returns - <strong>Crisis Impact</strong>: Education provided some protection, but all groups suffered significant losses during 2007-2010</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>